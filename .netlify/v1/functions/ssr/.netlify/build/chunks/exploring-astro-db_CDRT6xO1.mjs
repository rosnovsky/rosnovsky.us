import { c as createComponent, r as renderTemplate, i as renderUniqueStylesheet, j as renderScriptElement, u as unescapeHTML, k as createHeadAndContent, a as renderComponent, H as isHTMLString, d as createAstro, m as maybeRenderHead, g as renderSlot } from './astro/server_COLE3fTq.mjs';
import 'kleur/colors';
import Markdoc$1 from '@markdoc/markdoc';
import Slugger from 'github-slugger';
import { c as isRelativePath } from './consts_Cw6Ya3su.mjs';
import { $ as $$Image } from './_astro_assets_D6TztbRf.mjs';
import { $ as $$Icon } from './Icon_Dq2hKnsC.mjs';

const ComponentNode = createComponent({
  factory(result, { treeNode }) {
    if (treeNode.type === "text") return renderTemplate`${treeNode.content}`;
    const slots = {
      default: () => renderTemplate`${treeNode.children.map(
        (child) => renderComponent(result, "ComponentNode", ComponentNode, { treeNode: child })
      )}`
    };
    if (treeNode.type === "component") {
      let styles = "", links = "", scripts = "";
      if (Array.isArray(treeNode.collectedStyles)) {
        styles = treeNode.collectedStyles.map(
          (style) => renderUniqueStylesheet(result, {
            type: "inline",
            content: style
          })
        ).join("");
      }
      if (Array.isArray(treeNode.collectedLinks)) {
        links = treeNode.collectedLinks.map((link) => {
          return renderUniqueStylesheet(result, {
            type: "external",
            src: link[0] === "/" ? link : "/" + link
          });
        }).join("");
      }
      if (Array.isArray(treeNode.collectedScripts)) {
        scripts = treeNode.collectedScripts.map((script) => renderScriptElement(script)).join("");
      }
      const head = unescapeHTML(styles + links + scripts);
      let headAndContent = createHeadAndContent(
        head,
        renderTemplate`${renderComponent(
          result,
          treeNode.component.name,
          treeNode.component,
          treeNode.props,
          slots
        )}`
      );
      result._metadata.propagators.add({
        init() {
          return headAndContent;
        }
      });
      return headAndContent;
    }
    return renderComponent(result, treeNode.tag, treeNode.tag, treeNode.attributes, slots);
  },
  propagation: "self"
});
async function createTreeNode(node) {
  if (isHTMLString(node)) {
    return { type: "text", content: node };
  } else if (typeof node === "string" || typeof node === "number") {
    return { type: "text", content: String(node) };
  } else if (node === null || typeof node !== "object" || !Markdoc$1.Tag.isTag(node)) {
    return { type: "text", content: "" };
  }
  const children = await Promise.all(node.children.map((child) => createTreeNode(child)));
  if (typeof node.name === "function") {
    const component = node.name;
    const props = node.attributes;
    return {
      type: "component",
      component,
      props,
      children
    };
  } else if (isPropagatedAssetsModule(node.name)) {
    const { collectedStyles, collectedLinks, collectedScripts } = node.name;
    const component = (await node.name.getMod()).default;
    const props = node.attributes;
    return {
      type: "component",
      component,
      collectedStyles,
      collectedLinks,
      collectedScripts,
      props,
      children
    };
  } else {
    return {
      type: "element",
      tag: node.name,
      attributes: node.attributes,
      children
    };
  }
}
function isPropagatedAssetsModule(module) {
  return typeof module === "object" && module != null && "__astroPropagation" in module;
}

const $$Astro$1 = createAstro("https://rosnovsky.us");
const $$Renderer = createComponent(async ($$result, $$props, $$slots) => {
  const Astro2 = $$result.createAstro($$Astro$1, $$props, $$slots);
  Astro2.self = $$Renderer;
  //! astro-head-inject
  const { stringifiedAst, config } = Astro2.props;
  const ast = Markdoc$1.Ast.fromJSON(stringifiedAst);
  const content = await Markdoc$1.transform(ast, config);
  return renderTemplate`${Array.isArray(content) ? content.map(async (c) => renderTemplate`${renderComponent($$result, "ComponentNode", ComponentNode, { "treeNode": await createTreeNode(c) })}`) : renderTemplate`${renderComponent($$result, "ComponentNode", ComponentNode, { "treeNode": await createTreeNode(content) })}`}`;
}, "/home/rosnovsky/code/rosnovsky.us/node_modules/.pnpm/@astrojs+markdoc@0.12.4_@types+react@19.0.2_astro@5.1.1_@types+node@22.10.2_jiti@2.4.2_rollup_szcb3xeuwaktkz2crfpemfkcvy/node_modules/@astrojs/markdoc/components/Renderer.astro", void 0);

class MarkdocError extends Error {
  loc;
  title;
  hint;
  frame;
  type = "MarkdocError";
  constructor(props, ...params) {
    super(...params);
    const { title = "MarkdocError", message, stack, location, hint, frame } = props;
    this.title = title;
    if (message) this.message = message;
    this.stack = stack ? stack : this.stack;
    this.loc = location;
    this.hint = hint;
    this.frame = frame;
  }
}
const componentConfigSymbol = Symbol.for("@astrojs/markdoc/component-config");

function getSlug(attributes, children, headingSlugger) {
  if (attributes.id && typeof attributes.id === "string") {
    return attributes.id;
  }
  const textContent = attributes.content ?? getTextContent(children);
  let slug = headingSlugger.slug(textContent);
  if (slug.endsWith("-")) slug = slug.slice(0, -1);
  return slug;
}
const heading = {
  children: ["inline"],
  attributes: {
    id: { type: String },
    level: { type: Number, required: true, default: 1 }
  },
  transform(node, config) {
    const { level, ...attributes } = node.transformAttributes(config);
    const children = node.transformChildren(config);
    if (!config.ctx?.headingSlugger) {
      throw new MarkdocError({
        message: "Unexpected problem adding heading IDs to Markdoc file. Did you modify the `ctx.headingSlugger` property in your Markdoc config?"
      });
    }
    const slug = getSlug(attributes, children, config.ctx.headingSlugger);
    const render = config.nodes?.heading?.render ?? `h${level}`;
    const tagProps = (
      // For components, pass down `level` as a prop,
      // alongside `__collectHeading` for our `headings` collector.
      // Avoid accidentally rendering `level` as an HTML attribute otherwise!
      typeof render === "string" ? { ...attributes, id: slug } : { ...attributes, id: slug, __collectHeading: true, level }
    );
    return new Markdoc$1.Tag(render, tagProps, children);
  }
};
function setupHeadingConfig() {
  const headingSlugger = new Slugger();
  return {
    ctx: {
      headingSlugger
    },
    nodes: {
      heading
    }
  };
}

async function setupConfig(userConfig = {}, options) {
  let defaultConfig = setupHeadingConfig();
  if (userConfig.extends) {
    for (let extension of userConfig.extends) {
      if (extension instanceof Promise) {
        extension = await extension;
      }
      defaultConfig = mergeConfig(defaultConfig, extension);
    }
  }
  let merged = mergeConfig(defaultConfig, userConfig);
  return merged;
}
function setupConfigSync(userConfig = {}, options) {
  const defaultConfig = setupHeadingConfig();
  let merged = mergeConfig(defaultConfig, userConfig);
  return merged;
}
function mergeConfig(configA, configB) {
  return {
    ...configA,
    ...configB,
    ctx: {
      ...configA.ctx,
      ...configB.ctx
    },
    tags: {
      ...configA.tags,
      ...configB.tags
    },
    nodes: {
      ...configA.nodes,
      ...configB.nodes
    },
    functions: {
      ...configA.functions,
      ...configB.functions
    },
    variables: {
      ...configA.variables,
      ...configB.variables
    },
    partials: {
      ...configA.partials,
      ...configB.partials
    },
    validation: {
      ...configA.validation,
      ...configB.validation
    }
  };
}
function resolveComponentImports(markdocConfig, tagComponentMap, nodeComponentMap) {
  for (const [tag, render] of Object.entries(tagComponentMap)) {
    const config = markdocConfig.tags[tag];
    if (config) config.render = render;
  }
  for (const [node, render] of Object.entries(nodeComponentMap)) {
    const config = markdocConfig.nodes[node];
    if (config) config.render = render;
  }
  return markdocConfig;
}
function getTextContent(childNodes) {
  let text = "";
  for (const node of childNodes) {
    if (typeof node === "string" || typeof node === "number") {
      text += node;
    } else if (typeof node === "object" && Markdoc$1.Tag.isTag(node)) {
      text += getTextContent(node.children);
    }
  }
  return text;
}
const headingLevels = [1, 2, 3, 4, 5, 6];
function collectHeadings(children, collectedHeadings) {
  for (const node of children) {
    if (typeof node !== "object" || !Markdoc$1.Tag.isTag(node)) continue;
    if (node.attributes.__collectHeading === true && typeof node.attributes.level === "number") {
      collectedHeadings.push({
        slug: node.attributes.id,
        depth: node.attributes.level,
        text: getTextContent(node.children)
      });
      continue;
    }
    for (const level of headingLevels) {
      if (node.name === "h" + level) {
        collectedHeadings.push({
          slug: node.attributes.id,
          depth: level,
          text: getTextContent(node.children)
        });
      }
    }
    collectHeadings(node.children, collectedHeadings);
  }
}
function createGetHeadings(stringifiedAst, userConfig, options) {
  return function getHeadings() {
    const config = setupConfigSync(userConfig);
    const ast = Markdoc$1.Ast.fromJSON(stringifiedAst);
    const content = Markdoc$1.transform(ast, config);
    let collectedHeadings = [];
    collectHeadings(Array.isArray(content) ? content : [content], collectedHeadings);
    return collectedHeadings;
  };
}
function createContentComponent(Renderer, stringifiedAst, userConfig, options, tagComponentMap, nodeComponentMap) {
  return createComponent({
    async factory(result, props) {
      const withVariables = mergeConfig(userConfig, { variables: props });
      const config = resolveComponentImports(
        await setupConfig(withVariables),
        tagComponentMap,
        nodeComponentMap
      );
      return renderComponent(result, Renderer.name, Renderer, { stringifiedAst, config }, {});
    },
    propagation: "self"
  });
}

const Markdoc = Markdoc$1;
({ ...Markdoc.nodes, heading });
function defineMarkdocConfig(config) {
  return config;
}
function component(pathnameOrPkgName, namedExport) {
  return {
    type: isNpmPackageName(pathnameOrPkgName) ? "package" : "local",
    path: pathnameOrPkgName,
    namedExport,
    [componentConfigSymbol]: true
  };
}
function isNpmPackageName(pathname) {
  return !isRelativePath(pathname) && !pathname.startsWith("/");
}

const markdocConfig = defineMarkdocConfig({
  tags: {
    callout: {
      render: component('./src/components/Callout.astro'),
      attributes: {
        type: { type: String },
        title: { type: String },
        content: { type: String },
      },
    },
  },
});

const assetsConfig = {
  nodes: {
    image: {
      attributes: {
        ...Markdoc$1.nodes.image.attributes,
        __optimizedSrc: { type: "Object" }
      },
      transform(node, config) {
        const attributes = node.transformAttributes(config);
        const children = node.transformChildren(config);
        if (node.type === "image" && "__optimizedSrc" in node.attributes) {
          const { __optimizedSrc, ...rest } = node.attributes;
          return new Markdoc$1.Tag($$Image, { ...rest, src: __optimizedSrc }, children);
        } else {
          return new Markdoc$1.Tag("img", attributes, children);
        }
      }
    }
  }
};

const $$Astro = createAstro("https://rosnovsky.us");
const $$Callout = createComponent(($$result, $$props, $$slots) => {
  const Astro2 = $$result.createAstro($$Astro, $$props, $$slots);
  Astro2.self = $$Callout;
  Astro2.props;
  return renderTemplate`${maybeRenderHead()}<div class="container rounded-lg border border-slate-600 p-6 dark:border-slate-400 dark:bg-slate-800"> <div class="flex max-h-20 flex-row place-items-center gap-x-4"> ${renderComponent($$result, "Icon", $$Icon, { "name": "material-symbols:info-rounded", "class": "max-h-5 w-5 text-slate-600 dark:text-slate-400" })} ${renderSlot($$result, $$slots["default"])} </div> </div>`;
}, "/home/rosnovsky/code/rosnovsky.us/src/components/Callout.astro", void 0);

markdocConfig.nodes = { ...assetsConfig.nodes, ...markdocConfig.nodes };



const tagComponentMap = {"callout": $$Callout,
};
const nodeComponentMap = {};

const options = undefined;

const stringifiedAst = "{\"$$mdtype\":\"Node\",\"errors\":[],\"lines\":[],\"inline\":false,\"attributes\":{},\"children\":[{\"$$mdtype\":\"Node\",\"errors\":[],\"lines\":[8,9,10,11],\"inline\":false,\"attributes\":{\"title\":\"Update\"},\"children\":[{\"$$mdtype\":\"Node\",\"errors\":[],\"lines\":[9,10],\"inline\":false,\"attributes\":{},\"children\":[{\"$$mdtype\":\"Node\",\"errors\":[],\"lines\":[9,10],\"inline\":false,\"attributes\":{},\"children\":[{\"$$mdtype\":\"Node\",\"errors\":[],\"lines\":[9,10],\"inline\":true,\"attributes\":{\"content\":\"As of September 2024, Astro DB has been officially deprecated: \"},\"children\":[],\"type\":\"text\",\"annotations\":[],\"slots\":{},\"location\":{\"start\":{\"line\":9},\"end\":{\"line\":10}}},{\"$$mdtype\":\"Node\",\"errors\":[],\"lines\":[9,10],\"inline\":true,\"attributes\":{\"href\":\"https://astro.build/blog/goodbye-astro-studio/\"},\"children\":[{\"$$mdtype\":\"Node\",\"errors\":[],\"lines\":[9,10],\"inline\":true,\"attributes\":{\"content\":\"Goodbye Studio, Hello DB\"},\"children\":[],\"type\":\"text\",\"annotations\":[],\"slots\":{},\"location\":{\"start\":{\"line\":9},\"end\":{\"line\":10}}}],\"type\":\"link\",\"annotations\":[],\"slots\":{},\"location\":{\"start\":{\"line\":9},\"end\":{\"line\":10}}},{\"$$mdtype\":\"Node\",\"errors\":[],\"lines\":[9,10],\"inline\":true,\"attributes\":{\"content\":\".\"},\"children\":[],\"type\":\"text\",\"annotations\":[],\"slots\":{},\"location\":{\"start\":{\"line\":9},\"end\":{\"line\":10}}}],\"type\":\"inline\",\"annotations\":[],\"slots\":{},\"location\":{\"start\":{\"line\":9},\"end\":{\"line\":10}}}],\"type\":\"paragraph\",\"annotations\":[],\"slots\":{},\"location\":{\"start\":{\"line\":9},\"end\":{\"line\":10}}}],\"type\":\"tag\",\"tag\":\"callout\",\"annotations\":[{\"type\":\"attribute\",\"name\":\"title\",\"value\":\"Update\"}],\"slots\":{},\"location\":{\"start\":{\"line\":8},\"end\":{\"line\":9}}},{\"$$mdtype\":\"Node\",\"errors\":[],\"lines\":[12,13],\"inline\":false,\"attributes\":{\"level\":2},\"children\":[{\"$$mdtype\":\"Node\",\"errors\":[],\"lines\":[12,13],\"inline\":false,\"attributes\":{},\"children\":[{\"$$mdtype\":\"Node\",\"errors\":[],\"lines\":[12,13],\"inline\":true,\"attributes\":{\"content\":\"Astro DB\"},\"children\":[],\"type\":\"text\",\"annotations\":[],\"slots\":{},\"location\":{\"start\":{\"line\":12},\"end\":{\"line\":13}}}],\"type\":\"inline\",\"annotations\":[],\"slots\":{},\"location\":{\"start\":{\"line\":12},\"end\":{\"line\":13}}}],\"type\":\"heading\",\"annotations\":[],\"slots\":{},\"location\":{\"start\":{\"line\":12},\"end\":{\"line\":13}}},{\"$$mdtype\":\"Node\",\"errors\":[],\"lines\":[14,15],\"inline\":false,\"attributes\":{},\"children\":[{\"$$mdtype\":\"Node\",\"errors\":[],\"lines\":[14,15],\"inline\":false,\"attributes\":{},\"children\":[{\"$$mdtype\":\"Node\",\"errors\":[],\"lines\":[14,15],\"inline\":true,\"attributes\":{\"content\":\"Yesterday, the \"},\"children\":[],\"type\":\"text\",\"annotations\":[],\"slots\":{},\"location\":{\"start\":{\"line\":14},\"end\":{\"line\":15}}},{\"$$mdtype\":\"Node\",\"errors\":[],\"lines\":[14,15],\"inline\":true,\"attributes\":{\"href\":\"https://astro.build\"},\"children\":[{\"$$mdtype\":\"Node\",\"errors\":[],\"lines\":[14,15],\"inline\":true,\"attributes\":{\"content\":\"Astro\"},\"children\":[],\"type\":\"text\",\"annotations\":[],\"slots\":{},\"location\":{\"start\":{\"line\":14},\"end\":{\"line\":15}}}],\"type\":\"link\",\"annotations\":[],\"slots\":{},\"location\":{\"start\":{\"line\":14},\"end\":{\"line\":15}}},{\"$$mdtype\":\"Node\",\"errors\":[],\"lines\":[14,15],\"inline\":true,\"attributes\":{\"content\":\" team announced \"},\"children\":[],\"type\":\"text\",\"annotations\":[],\"slots\":{},\"location\":{\"start\":{\"line\":14},\"end\":{\"line\":15}}},{\"$$mdtype\":\"Node\",\"errors\":[],\"lines\":[14,15],\"inline\":true,\"attributes\":{\"href\":\"https://astro.build/db/\"},\"children\":[{\"$$mdtype\":\"Node\",\"errors\":[],\"lines\":[14,15],\"inline\":true,\"attributes\":{\"content\":\"Astro DB\"},\"children\":[],\"type\":\"text\",\"annotations\":[],\"slots\":{},\"location\":{\"start\":{\"line\":14},\"end\":{\"line\":15}}}],\"type\":\"link\",\"annotations\":[],\"slots\":{},\"location\":{\"start\":{\"line\":14},\"end\":{\"line\":15}}},{\"$$mdtype\":\"Node\",\"errors\":[],\"lines\":[14,15],\"inline\":true,\"attributes\":{\"content\":\" and \"},\"children\":[],\"type\":\"text\",\"annotations\":[],\"slots\":{},\"location\":{\"start\":{\"line\":14},\"end\":{\"line\":15}}},{\"$$mdtype\":\"Node\",\"errors\":[],\"lines\":[14,15],\"inline\":true,\"attributes\":{\"href\":\"https://docs.astro.build/en/recipes/studio/\"},\"children\":[{\"$$mdtype\":\"Node\",\"errors\":[],\"lines\":[14,15],\"inline\":true,\"attributes\":{\"content\":\"Astro Studio\"},\"children\":[],\"type\":\"text\",\"annotations\":[],\"slots\":{},\"location\":{\"start\":{\"line\":14},\"end\":{\"line\":15}}}],\"type\":\"link\",\"annotations\":[],\"slots\":{},\"location\":{\"start\":{\"line\":14},\"end\":{\"line\":15}}},{\"$$mdtype\":\"Node\",\"errors\":[],\"lines\":[14,15],\"inline\":true,\"attributes\":{\"content\":\". Astro DB is a fully-managed SQL database integrated directly with the framework, and Astro Studio is a hosted interface to Astro DB. Personally, I find this development significant for a few reasons:\"},\"children\":[],\"type\":\"text\",\"annotations\":[],\"slots\":{},\"location\":{\"start\":{\"line\":14},\"end\":{\"line\":15}}}],\"type\":\"inline\",\"annotations\":[],\"slots\":{},\"location\":{\"start\":{\"line\":14},\"end\":{\"line\":15}}}],\"type\":\"paragraph\",\"annotations\":[],\"slots\":{},\"location\":{\"start\":{\"line\":14},\"end\":{\"line\":15}}},{\"$$mdtype\":\"Node\",\"errors\":[],\"lines\":[16,22],\"inline\":false,\"attributes\":{\"ordered\":false,\"marker\":\"-\"},\"children\":[{\"$$mdtype\":\"Node\",\"errors\":[],\"lines\":[16,17],\"inline\":false,\"attributes\":{},\"children\":[{\"$$mdtype\":\"Node\",\"errors\":[],\"lines\":[16,17],\"inline\":false,\"attributes\":{},\"children\":[{\"$$mdtype\":\"Node\",\"errors\":[],\"lines\":[16,17],\"inline\":true,\"attributes\":{\"content\":\"Astro becomes more \\\"batteries included\\\"\"},\"children\":[],\"type\":\"text\",\"annotations\":[],\"slots\":{},\"location\":{\"start\":{\"line\":16},\"end\":{\"line\":17}}}],\"type\":\"inline\",\"annotations\":[],\"slots\":{},\"location\":{\"start\":{\"line\":16},\"end\":{\"line\":17}}}],\"type\":\"item\",\"annotations\":[],\"slots\":{},\"location\":{\"start\":{\"line\":16},\"end\":{\"line\":17}}},{\"$$mdtype\":\"Node\",\"errors\":[],\"lines\":[17,18],\"inline\":false,\"attributes\":{},\"children\":[{\"$$mdtype\":\"Node\",\"errors\":[],\"lines\":[17,18],\"inline\":false,\"attributes\":{},\"children\":[{\"$$mdtype\":\"Node\",\"errors\":[],\"lines\":[17,18],\"inline\":true,\"attributes\":{\"content\":\"Local DX involving running a local database gets much easier\"},\"children\":[],\"type\":\"text\",\"annotations\":[],\"slots\":{},\"location\":{\"start\":{\"line\":17},\"end\":{\"line\":18}}}],\"type\":\"inline\",\"annotations\":[],\"slots\":{},\"location\":{\"start\":{\"line\":17},\"end\":{\"line\":18}}}],\"type\":\"item\",\"annotations\":[],\"slots\":{},\"location\":{\"start\":{\"line\":17},\"end\":{\"line\":18}}},{\"$$mdtype\":\"Node\",\"errors\":[],\"lines\":[18,19],\"inline\":false,\"attributes\":{},\"children\":[{\"$$mdtype\":\"Node\",\"errors\":[],\"lines\":[18,19],\"inline\":false,\"attributes\":{},\"children\":[{\"$$mdtype\":\"Node\",\"errors\":[],\"lines\":[18,19],\"inline\":true,\"attributes\":{\"content\":\"It's just SQL so you can take it out at any moment and move to any other DB provider. The package for working with Astro DB, \"},\"children\":[],\"type\":\"text\",\"annotations\":[],\"slots\":{},\"location\":{\"start\":{\"line\":18},\"end\":{\"line\":19}}},{\"$$mdtype\":\"Node\",\"errors\":[],\"lines\":[18,19],\"inline\":true,\"attributes\":{\"href\":\"https://www.npmjs.com/package/@astrojs/db\"},\"children\":[{\"$$mdtype\":\"Node\",\"errors\":[],\"lines\":[18,19],\"inline\":true,\"attributes\":{\"content\":\"@astrojs/db\"},\"children\":[],\"type\":\"text\",\"annotations\":[],\"slots\":{},\"location\":{\"start\":{\"line\":18},\"end\":{\"line\":19}}}],\"type\":\"link\",\"annotations\":[],\"slots\":{},\"location\":{\"start\":{\"line\":18},\"end\":{\"line\":19}}},{\"$$mdtype\":\"Node\",\"errors\":[],\"lines\":[18,19],\"inline\":true,\"attributes\":{\"content\":\", includes \"},\"children\":[],\"type\":\"text\",\"annotations\":[],\"slots\":{},\"location\":{\"start\":{\"line\":18},\"end\":{\"line\":19}}},{\"$$mdtype\":\"Node\",\"errors\":[],\"lines\":[18,19],\"inline\":true,\"attributes\":{\"href\":\"https://orm.drizzle.team/\"},\"children\":[{\"$$mdtype\":\"Node\",\"errors\":[],\"lines\":[18,19],\"inline\":true,\"attributes\":{\"content\":\"Drizzle ORM\"},\"children\":[],\"type\":\"text\",\"annotations\":[],\"slots\":{},\"location\":{\"start\":{\"line\":18},\"end\":{\"line\":19}}}],\"type\":\"link\",\"annotations\":[],\"slots\":{},\"location\":{\"start\":{\"line\":18},\"end\":{\"line\":19}}},{\"$$mdtype\":\"Node\",\"errors\":[],\"lines\":[18,19],\"inline\":true,\"attributes\":{\"content\":\" so migration to a different provider should be relatively painless\"},\"children\":[],\"type\":\"text\",\"annotations\":[],\"slots\":{},\"location\":{\"start\":{\"line\":18},\"end\":{\"line\":19}}}],\"type\":\"inline\",\"annotations\":[],\"slots\":{},\"location\":{\"start\":{\"line\":18},\"end\":{\"line\":19}}}],\"type\":\"item\",\"annotations\":[],\"slots\":{},\"location\":{\"start\":{\"line\":18},\"end\":{\"line\":19}}},{\"$$mdtype\":\"Node\",\"errors\":[],\"lines\":[19,20],\"inline\":false,\"attributes\":{},\"children\":[{\"$$mdtype\":\"Node\",\"errors\":[],\"lines\":[19,20],\"inline\":false,\"attributes\":{},\"children\":[{\"$$mdtype\":\"Node\",\"errors\":[],\"lines\":[19,20],\"inline\":true,\"attributes\":{\"content\":\"Astro DB's free tier is generous but not \"},\"children\":[],\"type\":\"text\",\"annotations\":[],\"slots\":{},\"location\":{\"start\":{\"line\":19},\"end\":{\"line\":20}}},{\"$$mdtype\":\"Node\",\"errors\":[],\"lines\":[19,20],\"inline\":true,\"attributes\":{\"marker\":\"_\"},\"children\":[{\"$$mdtype\":\"Node\",\"errors\":[],\"lines\":[19,20],\"inline\":true,\"attributes\":{\"content\":\"outrageously\"},\"children\":[],\"type\":\"text\",\"annotations\":[],\"slots\":{},\"location\":{\"start\":{\"line\":19},\"end\":{\"line\":20}}}],\"type\":\"em\",\"annotations\":[],\"slots\":{},\"location\":{\"start\":{\"line\":19},\"end\":{\"line\":20}}},{\"$$mdtype\":\"Node\",\"errors\":[],\"lines\":[19,20],\"inline\":true,\"attributes\":{\"content\":\" so (yes, it's a jab at \"},\"children\":[],\"type\":\"text\",\"annotations\":[],\"slots\":{},\"location\":{\"start\":{\"line\":19},\"end\":{\"line\":20}}},{\"$$mdtype\":\"Node\",\"errors\":[],\"lines\":[19,20],\"inline\":true,\"attributes\":{\"href\":\"https://planetscale.com/blog/planetscale-forever\"},\"children\":[{\"$$mdtype\":\"Node\",\"errors\":[],\"lines\":[19,20],\"inline\":true,\"attributes\":{\"content\":\"PlanetScale\"},\"children\":[],\"type\":\"text\",\"annotations\":[],\"slots\":{},\"location\":{\"start\":{\"line\":19},\"end\":{\"line\":20}}}],\"type\":\"link\",\"annotations\":[],\"slots\":{},\"location\":{\"start\":{\"line\":19},\"end\":{\"line\":20}}},{\"$$mdtype\":\"Node\",\"errors\":[],\"lines\":[19,20],\"inline\":true,\"attributes\":{\"content\":\", I'm still salty); paid usage is \"},\"children\":[],\"type\":\"text\",\"annotations\":[],\"slots\":{},\"location\":{\"start\":{\"line\":19},\"end\":{\"line\":20}}},{\"$$mdtype\":\"Node\",\"errors\":[],\"lines\":[19,20],\"inline\":true,\"attributes\":{\"marker\":\"_\"},\"children\":[{\"$$mdtype\":\"Node\",\"errors\":[],\"lines\":[19,20],\"inline\":true,\"attributes\":{\"content\":\"very\"},\"children\":[],\"type\":\"text\",\"annotations\":[],\"slots\":{},\"location\":{\"start\":{\"line\":19},\"end\":{\"line\":20}}}],\"type\":\"em\",\"annotations\":[],\"slots\":{},\"location\":{\"start\":{\"line\":19},\"end\":{\"line\":20}}},{\"$$mdtype\":\"Node\",\"errors\":[],\"lines\":[19,20],\"inline\":true,\"attributes\":{\"content\":\" reasonably priced\"},\"children\":[],\"type\":\"text\",\"annotations\":[],\"slots\":{},\"location\":{\"start\":{\"line\":19},\"end\":{\"line\":20}}}],\"type\":\"inline\",\"annotations\":[],\"slots\":{},\"location\":{\"start\":{\"line\":19},\"end\":{\"line\":20}}}],\"type\":\"item\",\"annotations\":[],\"slots\":{},\"location\":{\"start\":{\"line\":19},\"end\":{\"line\":20}}},{\"$$mdtype\":\"Node\",\"errors\":[],\"lines\":[20,22],\"inline\":false,\"attributes\":{},\"children\":[{\"$$mdtype\":\"Node\",\"errors\":[],\"lines\":[20,21],\"inline\":false,\"attributes\":{},\"children\":[{\"$$mdtype\":\"Node\",\"errors\":[],\"lines\":[20,21],\"inline\":true,\"attributes\":{\"content\":\"It's easier than ever to add \\\"advanced\\\" dynamic features to static sites\"},\"children\":[],\"type\":\"text\",\"annotations\":[],\"slots\":{},\"location\":{\"start\":{\"line\":20},\"end\":{\"line\":21}}}],\"type\":\"inline\",\"annotations\":[],\"slots\":{},\"location\":{\"start\":{\"line\":20},\"end\":{\"line\":21}}}],\"type\":\"item\",\"annotations\":[],\"slots\":{},\"location\":{\"start\":{\"line\":20},\"end\":{\"line\":22}}}],\"type\":\"list\",\"annotations\":[],\"slots\":{},\"location\":{\"start\":{\"line\":16},\"end\":{\"line\":22}}},{\"$$mdtype\":\"Node\",\"errors\":[],\"lines\":[22,23],\"inline\":false,\"attributes\":{},\"children\":[{\"$$mdtype\":\"Node\",\"errors\":[],\"lines\":[22,23],\"inline\":false,\"attributes\":{},\"children\":[{\"$$mdtype\":\"Node\",\"errors\":[],\"lines\":[22,23],\"inline\":true,\"attributes\":{\"content\":\"You may have a different set of reasons why it's worth talking about Astro DB, but we can probably agree that in this space, this is great news. The only thing to keep in mind is that it's still in \\\"Early Preview\\\" stage, so I wouldn't recommend relying on Astro DB for critical production workloads.\"},\"children\":[],\"type\":\"text\",\"annotations\":[],\"slots\":{},\"location\":{\"start\":{\"line\":22},\"end\":{\"line\":23}}}],\"type\":\"inline\",\"annotations\":[],\"slots\":{},\"location\":{\"start\":{\"line\":22},\"end\":{\"line\":23}}}],\"type\":\"paragraph\",\"annotations\":[],\"slots\":{},\"location\":{\"start\":{\"line\":22},\"end\":{\"line\":23}}},{\"$$mdtype\":\"Node\",\"errors\":[],\"lines\":[24,25],\"inline\":false,\"attributes\":{},\"children\":[{\"$$mdtype\":\"Node\",\"errors\":[],\"lines\":[24,25],\"inline\":false,\"attributes\":{},\"children\":[{\"$$mdtype\":\"Node\",\"errors\":[],\"lines\":[24,25],\"inline\":true,\"attributes\":{\"content\":\"Anyway, as soon as I saw the announcement, I jumped right in and tried to implement a feature for my blog: a basic page views counter. How hard could it be?\"},\"children\":[],\"type\":\"text\",\"annotations\":[],\"slots\":{},\"location\":{\"start\":{\"line\":24},\"end\":{\"line\":25}}}],\"type\":\"inline\",\"annotations\":[],\"slots\":{},\"location\":{\"start\":{\"line\":24},\"end\":{\"line\":25}}}],\"type\":\"paragraph\",\"annotations\":[],\"slots\":{},\"location\":{\"start\":{\"line\":24},\"end\":{\"line\":25}}},{\"$$mdtype\":\"Node\",\"errors\":[],\"lines\":[26,27],\"inline\":false,\"attributes\":{\"level\":2},\"children\":[{\"$$mdtype\":\"Node\",\"errors\":[],\"lines\":[26,27],\"inline\":false,\"attributes\":{},\"children\":[{\"$$mdtype\":\"Node\",\"errors\":[],\"lines\":[26,27],\"inline\":true,\"attributes\":{\"content\":\"Page views counter\"},\"children\":[],\"type\":\"text\",\"annotations\":[],\"slots\":{},\"location\":{\"start\":{\"line\":26},\"end\":{\"line\":27}}}],\"type\":\"inline\",\"annotations\":[],\"slots\":{},\"location\":{\"start\":{\"line\":26},\"end\":{\"line\":27}}}],\"type\":\"heading\",\"annotations\":[],\"slots\":{},\"location\":{\"start\":{\"line\":26},\"end\":{\"line\":27}}},{\"$$mdtype\":\"Node\",\"errors\":[],\"lines\":[28,29],\"inline\":false,\"attributes\":{},\"children\":[{\"$$mdtype\":\"Node\",\"errors\":[],\"lines\":[28,29],\"inline\":false,\"attributes\":{},\"children\":[{\"$$mdtype\":\"Node\",\"errors\":[],\"lines\":[28,29],\"inline\":true,\"attributes\":{\"content\":\"I admit, it's not a very creative idea. My goal was to explore Astro DB, see how it works, so that I can actually use it for something fun later. So, page views counter it is.\"},\"children\":[],\"type\":\"text\",\"annotations\":[],\"slots\":{},\"location\":{\"start\":{\"line\":28},\"end\":{\"line\":29}}}],\"type\":\"inline\",\"annotations\":[],\"slots\":{},\"location\":{\"start\":{\"line\":28},\"end\":{\"line\":29}}}],\"type\":\"paragraph\",\"annotations\":[],\"slots\":{},\"location\":{\"start\":{\"line\":28},\"end\":{\"line\":29}}},{\"$$mdtype\":\"Node\",\"errors\":[],\"lines\":[30,31],\"inline\":false,\"attributes\":{},\"children\":[{\"$$mdtype\":\"Node\",\"errors\":[],\"lines\":[30,31],\"inline\":false,\"attributes\":{},\"children\":[{\"$$mdtype\":\"Node\",\"errors\":[],\"lines\":[30,31],\"inline\":true,\"attributes\":{\"content\":\"The plan was simple:\"},\"children\":[],\"type\":\"text\",\"annotations\":[],\"slots\":{},\"location\":{\"start\":{\"line\":30},\"end\":{\"line\":31}}}],\"type\":\"inline\",\"annotations\":[],\"slots\":{},\"location\":{\"start\":{\"line\":30},\"end\":{\"line\":31}}}],\"type\":\"paragraph\",\"annotations\":[],\"slots\":{},\"location\":{\"start\":{\"line\":30},\"end\":{\"line\":31}}},{\"$$mdtype\":\"Node\",\"errors\":[],\"lines\":[31,37],\"inline\":false,\"attributes\":{\"ordered\":false,\"marker\":\"-\"},\"children\":[{\"$$mdtype\":\"Node\",\"errors\":[],\"lines\":[31,32],\"inline\":false,\"attributes\":{},\"children\":[{\"$$mdtype\":\"Node\",\"errors\":[],\"lines\":[31,32],\"inline\":false,\"attributes\":{},\"children\":[{\"$$mdtype\":\"Node\",\"errors\":[],\"lines\":[31,32],\"inline\":true,\"attributes\":{\"content\":\"Whenever somebody visits any page on my website, I'd record their visit in the database\"},\"children\":[],\"type\":\"text\",\"annotations\":[],\"slots\":{},\"location\":{\"start\":{\"line\":31},\"end\":{\"line\":32}}}],\"type\":\"inline\",\"annotations\":[],\"slots\":{},\"location\":{\"start\":{\"line\":31},\"end\":{\"line\":32}}}],\"type\":\"item\",\"annotations\":[],\"slots\":{},\"location\":{\"start\":{\"line\":31},\"end\":{\"line\":32}}},{\"$$mdtype\":\"Node\",\"errors\":[],\"lines\":[32,33],\"inline\":false,\"attributes\":{},\"children\":[{\"$$mdtype\":\"Node\",\"errors\":[],\"lines\":[32,33],\"inline\":false,\"attributes\":{},\"children\":[{\"$$mdtype\":\"Node\",\"errors\":[],\"lines\":[32,33],\"inline\":true,\"attributes\":{\"content\":\"To make this counter a little more resilient, I'd also record hashed user IP address and their hashed user agent (I don't want to collect or store \"},\"children\":[],\"type\":\"text\",\"annotations\":[],\"slots\":{},\"location\":{\"start\":{\"line\":32},\"end\":{\"line\":33}}},{\"$$mdtype\":\"Node\",\"errors\":[],\"lines\":[32,33],\"inline\":true,\"attributes\":{\"marker\":\"_\"},\"children\":[{\"$$mdtype\":\"Node\",\"errors\":[],\"lines\":[32,33],\"inline\":true,\"attributes\":{\"content\":\"actual\"},\"children\":[],\"type\":\"text\",\"annotations\":[],\"slots\":{},\"location\":{\"start\":{\"line\":32},\"end\":{\"line\":33}}}],\"type\":\"em\",\"annotations\":[],\"slots\":{},\"location\":{\"start\":{\"line\":32},\"end\":{\"line\":33}}},{\"$$mdtype\":\"Node\",\"errors\":[],\"lines\":[32,33],\"inline\":true,\"attributes\":{\"content\":\" IPs and user agents, but I do want to be able to identify whether somebody is just hitting refresh or actually visiting a page)\"},\"children\":[],\"type\":\"text\",\"annotations\":[],\"slots\":{},\"location\":{\"start\":{\"line\":32},\"end\":{\"line\":33}}}],\"type\":\"inline\",\"annotations\":[],\"slots\":{},\"location\":{\"start\":{\"line\":32},\"end\":{\"line\":33}}}],\"type\":\"item\",\"annotations\":[],\"slots\":{},\"location\":{\"start\":{\"line\":32},\"end\":{\"line\":33}}},{\"$$mdtype\":\"Node\",\"errors\":[],\"lines\":[33,34],\"inline\":false,\"attributes\":{},\"children\":[{\"$$mdtype\":\"Node\",\"errors\":[],\"lines\":[33,34],\"inline\":false,\"attributes\":{},\"children\":[{\"$$mdtype\":\"Node\",\"errors\":[],\"lines\":[33,34],\"inline\":true,\"attributes\":{\"content\":\"I also need to record that page is being visited\"},\"children\":[],\"type\":\"text\",\"annotations\":[],\"slots\":{},\"location\":{\"start\":{\"line\":33},\"end\":{\"line\":34}}}],\"type\":\"inline\",\"annotations\":[],\"slots\":{},\"location\":{\"start\":{\"line\":33},\"end\":{\"line\":34}}}],\"type\":\"item\",\"annotations\":[],\"slots\":{},\"location\":{\"start\":{\"line\":33},\"end\":{\"line\":34}}},{\"$$mdtype\":\"Node\",\"errors\":[],\"lines\":[34,35],\"inline\":false,\"attributes\":{},\"children\":[{\"$$mdtype\":\"Node\",\"errors\":[],\"lines\":[34,35],\"inline\":false,\"attributes\":{},\"children\":[{\"$$mdtype\":\"Node\",\"errors\":[],\"lines\":[34,35],\"inline\":true,\"attributes\":{\"content\":\"I want to display the view counts per page\"},\"children\":[],\"type\":\"text\",\"annotations\":[],\"slots\":{},\"location\":{\"start\":{\"line\":34},\"end\":{\"line\":35}}}],\"type\":\"inline\",\"annotations\":[],\"slots\":{},\"location\":{\"start\":{\"line\":34},\"end\":{\"line\":35}}}],\"type\":\"item\",\"annotations\":[],\"slots\":{},\"location\":{\"start\":{\"line\":34},\"end\":{\"line\":35}}},{\"$$mdtype\":\"Node\",\"errors\":[],\"lines\":[35,37],\"inline\":false,\"attributes\":{},\"children\":[{\"$$mdtype\":\"Node\",\"errors\":[],\"lines\":[35,36],\"inline\":false,\"attributes\":{},\"children\":[{\"$$mdtype\":\"Node\",\"errors\":[],\"lines\":[35,36],\"inline\":true,\"attributes\":{\"content\":\"Finally, I want to display popular blog posts based on the number of page views\"},\"children\":[],\"type\":\"text\",\"annotations\":[],\"slots\":{},\"location\":{\"start\":{\"line\":35},\"end\":{\"line\":36}}}],\"type\":\"inline\",\"annotations\":[],\"slots\":{},\"location\":{\"start\":{\"line\":35},\"end\":{\"line\":36}}}],\"type\":\"item\",\"annotations\":[],\"slots\":{},\"location\":{\"start\":{\"line\":35},\"end\":{\"line\":37}}}],\"type\":\"list\",\"annotations\":[],\"slots\":{},\"location\":{\"start\":{\"line\":31},\"end\":{\"line\":37}}},{\"$$mdtype\":\"Node\",\"errors\":[],\"lines\":[37,38],\"inline\":false,\"attributes\":{},\"children\":[{\"$$mdtype\":\"Node\",\"errors\":[],\"lines\":[37,38],\"inline\":false,\"attributes\":{},\"children\":[{\"$$mdtype\":\"Node\",\"errors\":[],\"lines\":[37,38],\"inline\":true,\"attributes\":{\"content\":\"Multiple improvements to this basic approach can be made. But for my exploration purpose, this is quite enough.\"},\"children\":[],\"type\":\"text\",\"annotations\":[],\"slots\":{},\"location\":{\"start\":{\"line\":37},\"end\":{\"line\":38}}}],\"type\":\"inline\",\"annotations\":[],\"slots\":{},\"location\":{\"start\":{\"line\":37},\"end\":{\"line\":38}}}],\"type\":\"paragraph\",\"annotations\":[],\"slots\":{},\"location\":{\"start\":{\"line\":37},\"end\":{\"line\":38}}},{\"$$mdtype\":\"Node\",\"errors\":[],\"lines\":[39,40],\"inline\":false,\"attributes\":{\"level\":3},\"children\":[{\"$$mdtype\":\"Node\",\"errors\":[],\"lines\":[39,40],\"inline\":false,\"attributes\":{},\"children\":[{\"$$mdtype\":\"Node\",\"errors\":[],\"lines\":[39,40],\"inline\":true,\"attributes\":{\"content\":\"Configuration\"},\"children\":[],\"type\":\"text\",\"annotations\":[],\"slots\":{},\"location\":{\"start\":{\"line\":39},\"end\":{\"line\":40}}}],\"type\":\"inline\",\"annotations\":[],\"slots\":{},\"location\":{\"start\":{\"line\":39},\"end\":{\"line\":40}}}],\"type\":\"heading\",\"annotations\":[],\"slots\":{},\"location\":{\"start\":{\"line\":39},\"end\":{\"line\":40}}},{\"$$mdtype\":\"Node\",\"errors\":[],\"lines\":[41,42],\"inline\":false,\"attributes\":{},\"children\":[{\"$$mdtype\":\"Node\",\"errors\":[],\"lines\":[41,42],\"inline\":false,\"attributes\":{},\"children\":[{\"$$mdtype\":\"Node\",\"errors\":[],\"lines\":[41,42],\"inline\":true,\"attributes\":{\"content\":\"First things first. I'd need to install, enable, and configure @astrojs/db. There are different ways to install Astro integrations, and I usually prefer the automated one:\"},\"children\":[],\"type\":\"text\",\"annotations\":[],\"slots\":{},\"location\":{\"start\":{\"line\":41},\"end\":{\"line\":42}}}],\"type\":\"inline\",\"annotations\":[],\"slots\":{},\"location\":{\"start\":{\"line\":41},\"end\":{\"line\":42}}}],\"type\":\"paragraph\",\"annotations\":[],\"slots\":{},\"location\":{\"start\":{\"line\":41},\"end\":{\"line\":42}}},{\"$$mdtype\":\"Node\",\"errors\":[],\"lines\":[43,46],\"inline\":false,\"attributes\":{\"content\":\"pnpm astro add db\\n\",\"language\":\"sh\"},\"children\":[{\"$$mdtype\":\"Node\",\"errors\":[],\"lines\":[43,46],\"inline\":false,\"attributes\":{\"content\":\"pnpm astro add db\\n\"},\"children\":[],\"type\":\"text\",\"annotations\":[],\"slots\":{},\"location\":{\"start\":{\"line\":43},\"end\":{\"line\":46}}}],\"type\":\"fence\",\"annotations\":[],\"slots\":{},\"location\":{\"start\":{\"line\":43},\"end\":{\"line\":46}}},{\"$$mdtype\":\"Node\",\"errors\":[],\"lines\":[47,48],\"inline\":false,\"attributes\":{},\"children\":[{\"$$mdtype\":\"Node\",\"errors\":[],\"lines\":[47,48],\"inline\":false,\"attributes\":{},\"children\":[{\"$$mdtype\":\"Node\",\"errors\":[],\"lines\":[47,48],\"inline\":true,\"attributes\":{\"content\":\"This command installs the package, updates \"},\"children\":[],\"type\":\"text\",\"annotations\":[],\"slots\":{},\"location\":{\"start\":{\"line\":47},\"end\":{\"line\":48}}},{\"$$mdtype\":\"Node\",\"errors\":[],\"lines\":[47,48],\"inline\":true,\"attributes\":{\"content\":\"astro.config.mjs\"},\"children\":[],\"type\":\"code\",\"annotations\":[],\"slots\":{},\"location\":{\"start\":{\"line\":47},\"end\":{\"line\":48}}},{\"$$mdtype\":\"Node\",\"errors\":[],\"lines\":[47,48],\"inline\":true,\"attributes\":{\"content\":\", and creates a new directory called \"},\"children\":[],\"type\":\"text\",\"annotations\":[],\"slots\":{},\"location\":{\"start\":{\"line\":47},\"end\":{\"line\":48}}},{\"$$mdtype\":\"Node\",\"errors\":[],\"lines\":[47,48],\"inline\":true,\"attributes\":{\"content\":\"db\"},\"children\":[],\"type\":\"code\",\"annotations\":[],\"slots\":{},\"location\":{\"start\":{\"line\":47},\"end\":{\"line\":48}}},{\"$$mdtype\":\"Node\",\"errors\":[],\"lines\":[47,48],\"inline\":true,\"attributes\":{\"content\":\" with \"},\"children\":[],\"type\":\"text\",\"annotations\":[],\"slots\":{},\"location\":{\"start\":{\"line\":47},\"end\":{\"line\":48}}},{\"$$mdtype\":\"Node\",\"errors\":[],\"lines\":[47,48],\"inline\":true,\"attributes\":{\"content\":\"config.ts\"},\"children\":[],\"type\":\"code\",\"annotations\":[],\"slots\":{},\"location\":{\"start\":{\"line\":47},\"end\":{\"line\":48}}},{\"$$mdtype\":\"Node\",\"errors\":[],\"lines\":[47,48],\"inline\":true,\"attributes\":{\"content\":\" and \"},\"children\":[],\"type\":\"text\",\"annotations\":[],\"slots\":{},\"location\":{\"start\":{\"line\":47},\"end\":{\"line\":48}}},{\"$$mdtype\":\"Node\",\"errors\":[],\"lines\":[47,48],\"inline\":true,\"attributes\":{\"content\":\"seed.ts\"},\"children\":[],\"type\":\"code\",\"annotations\":[],\"slots\":{},\"location\":{\"start\":{\"line\":47},\"end\":{\"line\":48}}},{\"$$mdtype\":\"Node\",\"errors\":[],\"lines\":[47,48],\"inline\":true,\"attributes\":{\"content\":\" files in it. That's about it. The project is ready, let's dive in.\"},\"children\":[],\"type\":\"text\",\"annotations\":[],\"slots\":{},\"location\":{\"start\":{\"line\":47},\"end\":{\"line\":48}}}],\"type\":\"inline\",\"annotations\":[],\"slots\":{},\"location\":{\"start\":{\"line\":47},\"end\":{\"line\":48}}}],\"type\":\"paragraph\",\"annotations\":[],\"slots\":{},\"location\":{\"start\":{\"line\":47},\"end\":{\"line\":48}}},{\"$$mdtype\":\"Node\",\"errors\":[],\"lines\":[49,50],\"inline\":false,\"attributes\":{},\"children\":[{\"$$mdtype\":\"Node\",\"errors\":[],\"lines\":[49,50],\"inline\":false,\"attributes\":{},\"children\":[{\"$$mdtype\":\"Node\",\"errors\":[],\"lines\":[49,50],\"inline\":true,\"attributes\":{\"content\":\"Here's what my \"},\"children\":[],\"type\":\"text\",\"annotations\":[],\"slots\":{},\"location\":{\"start\":{\"line\":49},\"end\":{\"line\":50}}},{\"$$mdtype\":\"Node\",\"errors\":[],\"lines\":[49,50],\"inline\":true,\"attributes\":{\"content\":\"config.ts\"},\"children\":[],\"type\":\"code\",\"annotations\":[],\"slots\":{},\"location\":{\"start\":{\"line\":49},\"end\":{\"line\":50}}},{\"$$mdtype\":\"Node\",\"errors\":[],\"lines\":[49,50],\"inline\":true,\"attributes\":{\"content\":\" looks like:\"},\"children\":[],\"type\":\"text\",\"annotations\":[],\"slots\":{},\"location\":{\"start\":{\"line\":49},\"end\":{\"line\":50}}}],\"type\":\"inline\",\"annotations\":[],\"slots\":{},\"location\":{\"start\":{\"line\":49},\"end\":{\"line\":50}}}],\"type\":\"paragraph\",\"annotations\":[],\"slots\":{},\"location\":{\"start\":{\"line\":49},\"end\":{\"line\":50}}},{\"$$mdtype\":\"Node\",\"errors\":[],\"lines\":[51,71],\"inline\":false,\"attributes\":{\"content\":\"import { defineDb, defineTable, column } from 'astro:db';\\n\\nconst Visits = defineTable({\\n  columns: {\\n    id: column.number({ primaryKey: true }),\\n    page: column.text({ default: 'home' }),\\n    content: column.text({ default: \\\"none\\\" }),\\n    pagination: column.number({ default: 1 }),\\n    visitor_ip_hash: column.text(),\\n    visitor_user_agent_hash: column.text(),\\n    visitor_count: column.number({ default: 1 })\\n  }\\n});\\n\\n// https://astro.build/db/config\\nexport default defineDb({\\n  tables: { Visits }\\n});\\n\",\"language\":\"typescript\"},\"children\":[{\"$$mdtype\":\"Node\",\"errors\":[],\"lines\":[51,71],\"inline\":false,\"attributes\":{\"content\":\"import { defineDb, defineTable, column } from 'astro:db';\\n\\nconst Visits = defineTable({\\n  columns: {\\n    id: column.number({ primaryKey: true }),\\n    page: column.text({ default: 'home' }),\\n    content: column.text({ default: \\\"none\\\" }),\\n    pagination: column.number({ default: 1 }),\\n    visitor_ip_hash: column.text(),\\n    visitor_user_agent_hash: column.text(),\\n    visitor_count: column.number({ default: 1 })\\n  }\\n});\\n\\n// https://astro.build/db/config\\nexport default defineDb({\\n  tables: { Visits }\\n});\\n\"},\"children\":[],\"type\":\"text\",\"annotations\":[],\"slots\":{},\"location\":{\"start\":{\"line\":51},\"end\":{\"line\":71}}}],\"type\":\"fence\",\"annotations\":[],\"slots\":{},\"location\":{\"start\":{\"line\":51},\"end\":{\"line\":71}}},{\"$$mdtype\":\"Node\",\"errors\":[],\"lines\":[72,73],\"inline\":false,\"attributes\":{},\"children\":[{\"$$mdtype\":\"Node\",\"errors\":[],\"lines\":[72,73],\"inline\":false,\"attributes\":{},\"children\":[{\"$$mdtype\":\"Node\",\"errors\":[],\"lines\":[72,73],\"inline\":true,\"attributes\":{\"content\":\"Pretty self-explanatory: we import \"},\"children\":[],\"type\":\"text\",\"annotations\":[],\"slots\":{},\"location\":{\"start\":{\"line\":72},\"end\":{\"line\":73}}},{\"$$mdtype\":\"Node\",\"errors\":[],\"lines\":[72,73],\"inline\":true,\"attributes\":{\"content\":\"defineDb\"},\"children\":[],\"type\":\"code\",\"annotations\":[],\"slots\":{},\"location\":{\"start\":{\"line\":72},\"end\":{\"line\":73}}},{\"$$mdtype\":\"Node\",\"errors\":[],\"lines\":[72,73],\"inline\":true,\"attributes\":{\"content\":\" from \"},\"children\":[],\"type\":\"text\",\"annotations\":[],\"slots\":{},\"location\":{\"start\":{\"line\":72},\"end\":{\"line\":73}}},{\"$$mdtype\":\"Node\",\"errors\":[],\"lines\":[72,73],\"inline\":true,\"attributes\":{\"content\":\"astro:db\"},\"children\":[],\"type\":\"code\",\"annotations\":[],\"slots\":{},\"location\":{\"start\":{\"line\":72},\"end\":{\"line\":73}}},{\"$$mdtype\":\"Node\",\"errors\":[],\"lines\":[72,73],\"inline\":true,\"attributes\":{\"content\":\" so that we can define our database, \"},\"children\":[],\"type\":\"text\",\"annotations\":[],\"slots\":{},\"location\":{\"start\":{\"line\":72},\"end\":{\"line\":73}}},{\"$$mdtype\":\"Node\",\"errors\":[],\"lines\":[72,73],\"inline\":true,\"attributes\":{\"content\":\"defineTable\"},\"children\":[],\"type\":\"code\",\"annotations\":[],\"slots\":{},\"location\":{\"start\":{\"line\":72},\"end\":{\"line\":73}}},{\"$$mdtype\":\"Node\",\"errors\":[],\"lines\":[72,73],\"inline\":true,\"attributes\":{\"content\":\" so that we can define this database's tables, and \"},\"children\":[],\"type\":\"text\",\"annotations\":[],\"slots\":{},\"location\":{\"start\":{\"line\":72},\"end\":{\"line\":73}}},{\"$$mdtype\":\"Node\",\"errors\":[],\"lines\":[72,73],\"inline\":true,\"attributes\":{\"content\":\"column\"},\"children\":[],\"type\":\"code\",\"annotations\":[],\"slots\":{},\"location\":{\"start\":{\"line\":72},\"end\":{\"line\":73}}},{\"$$mdtype\":\"Node\",\"errors\":[],\"lines\":[72,73],\"inline\":true,\"attributes\":{\"content\":\", you guessed it, so that we can define this table's columns. There's more we can do, but for now that's all we need.\"},\"children\":[],\"type\":\"text\",\"annotations\":[],\"slots\":{},\"location\":{\"start\":{\"line\":72},\"end\":{\"line\":73}}}],\"type\":\"inline\",\"annotations\":[],\"slots\":{},\"location\":{\"start\":{\"line\":72},\"end\":{\"line\":73}}}],\"type\":\"paragraph\",\"annotations\":[],\"slots\":{},\"location\":{\"start\":{\"line\":72},\"end\":{\"line\":73}}},{\"$$mdtype\":\"Node\",\"errors\":[],\"lines\":[74,75],\"inline\":false,\"attributes\":{},\"children\":[{\"$$mdtype\":\"Node\",\"errors\":[],\"lines\":[74,75],\"inline\":false,\"attributes\":{},\"children\":[{\"$$mdtype\":\"Node\",\"errors\":[],\"lines\":[74,75],\"inline\":true,\"attributes\":{\"content\":\"Now, if you've ever worked with a local database, you know you now need to actually start the local database, create tables, and seed it. Well, with Astro DB, you only need to do the last step - seed the db. And \"},\"children\":[],\"type\":\"text\",\"annotations\":[],\"slots\":{},\"location\":{\"start\":{\"line\":74},\"end\":{\"line\":75}}},{\"$$mdtype\":\"Node\",\"errors\":[],\"lines\":[74,75],\"inline\":true,\"attributes\":{\"marker\":\"_\"},\"children\":[{\"$$mdtype\":\"Node\",\"errors\":[],\"lines\":[74,75],\"inline\":true,\"attributes\":{\"content\":\"need\"},\"children\":[],\"type\":\"text\",\"annotations\":[],\"slots\":{},\"location\":{\"start\":{\"line\":74},\"end\":{\"line\":75}}}],\"type\":\"em\",\"annotations\":[],\"slots\":{},\"location\":{\"start\":{\"line\":74},\"end\":{\"line\":75}}},{\"$$mdtype\":\"Node\",\"errors\":[],\"lines\":[74,75],\"inline\":true,\"attributes\":{\"content\":\" is really \"},\"children\":[],\"type\":\"text\",\"annotations\":[],\"slots\":{},\"location\":{\"start\":{\"line\":74},\"end\":{\"line\":75}}},{\"$$mdtype\":\"Node\",\"errors\":[],\"lines\":[74,75],\"inline\":true,\"attributes\":{\"marker\":\"_\"},\"children\":[{\"$$mdtype\":\"Node\",\"errors\":[],\"lines\":[74,75],\"inline\":true,\"attributes\":{\"content\":\"want\"},\"children\":[],\"type\":\"text\",\"annotations\":[],\"slots\":{},\"location\":{\"start\":{\"line\":74},\"end\":{\"line\":75}}}],\"type\":\"em\",\"annotations\":[],\"slots\":{},\"location\":{\"start\":{\"line\":74},\"end\":{\"line\":75}}},{\"$$mdtype\":\"Node\",\"errors\":[],\"lines\":[74,75],\"inline\":true,\"attributes\":{\"content\":\": you're not \"},\"children\":[],\"type\":\"text\",\"annotations\":[],\"slots\":{},\"location\":{\"start\":{\"line\":74},\"end\":{\"line\":75}}},{\"$$mdtype\":\"Node\",\"errors\":[],\"lines\":[74,75],\"inline\":true,\"attributes\":{\"marker\":\"_\"},\"children\":[{\"$$mdtype\":\"Node\",\"errors\":[],\"lines\":[74,75],\"inline\":true,\"attributes\":{\"content\":\"required\"},\"children\":[],\"type\":\"text\",\"annotations\":[],\"slots\":{},\"location\":{\"start\":{\"line\":74},\"end\":{\"line\":75}}}],\"type\":\"em\",\"annotations\":[],\"slots\":{},\"location\":{\"start\":{\"line\":74},\"end\":{\"line\":75}}},{\"$$mdtype\":\"Node\",\"errors\":[],\"lines\":[74,75],\"inline\":true,\"attributes\":{\"content\":\" to seed the database, it just makes life easier down the line.\"},\"children\":[],\"type\":\"text\",\"annotations\":[],\"slots\":{},\"location\":{\"start\":{\"line\":74},\"end\":{\"line\":75}}}],\"type\":\"inline\",\"annotations\":[],\"slots\":{},\"location\":{\"start\":{\"line\":74},\"end\":{\"line\":75}}}],\"type\":\"paragraph\",\"annotations\":[],\"slots\":{},\"location\":{\"start\":{\"line\":74},\"end\":{\"line\":75}}},{\"$$mdtype\":\"Node\",\"errors\":[],\"lines\":[76,90],\"inline\":false,\"attributes\":{\"content\":\"import { db, Visits } from 'astro:db';\\n\\n// https://astro.build/db/seed\\nexport default async function seed() {\\n\\tawait db.insert(Visits).values({\\n\\t\\tpage: 'home',\\n\\t\\tpagination: 1,\\n\\t\\tvisitor_ip_hash: '30963a87dd481e4366237ed9cb37f001e24bcb865833be0036f7f081176b9812',\\n\\t\\tvisitor_user_agent_hash: 'c08ae1ccbe7296f4d6589acb026c5a0379bb07f1915cca8829d4cead13211e26',\\n\\t\\tvisitor_count: 10\\n\\t});\\n}\\n\",\"language\":\"typescript\"},\"children\":[{\"$$mdtype\":\"Node\",\"errors\":[],\"lines\":[76,90],\"inline\":false,\"attributes\":{\"content\":\"import { db, Visits } from 'astro:db';\\n\\n// https://astro.build/db/seed\\nexport default async function seed() {\\n\\tawait db.insert(Visits).values({\\n\\t\\tpage: 'home',\\n\\t\\tpagination: 1,\\n\\t\\tvisitor_ip_hash: '30963a87dd481e4366237ed9cb37f001e24bcb865833be0036f7f081176b9812',\\n\\t\\tvisitor_user_agent_hash: 'c08ae1ccbe7296f4d6589acb026c5a0379bb07f1915cca8829d4cead13211e26',\\n\\t\\tvisitor_count: 10\\n\\t});\\n}\\n\"},\"children\":[],\"type\":\"text\",\"annotations\":[],\"slots\":{},\"location\":{\"start\":{\"line\":76},\"end\":{\"line\":90}}}],\"type\":\"fence\",\"annotations\":[],\"slots\":{},\"location\":{\"start\":{\"line\":76},\"end\":{\"line\":90}}},{\"$$mdtype\":\"Node\",\"errors\":[],\"lines\":[91,92],\"inline\":false,\"attributes\":{},\"children\":[{\"$$mdtype\":\"Node\",\"errors\":[],\"lines\":[91,92],\"inline\":false,\"attributes\":{},\"children\":[{\"$$mdtype\":\"Node\",\"errors\":[],\"lines\":[91,92],\"inline\":true,\"attributes\":{\"content\":\"This file will create a record in the local database (you \"},\"children\":[],\"type\":\"text\",\"annotations\":[],\"slots\":{},\"location\":{\"start\":{\"line\":91},\"end\":{\"line\":92}}},{\"$$mdtype\":\"Node\",\"errors\":[],\"lines\":[91,92],\"inline\":true,\"attributes\":{\"marker\":\"_\"},\"children\":[{\"$$mdtype\":\"Node\",\"errors\":[],\"lines\":[91,92],\"inline\":true,\"attributes\":{\"content\":\"can\"},\"children\":[],\"type\":\"text\",\"annotations\":[],\"slots\":{},\"location\":{\"start\":{\"line\":91},\"end\":{\"line\":92}}}],\"type\":\"em\",\"annotations\":[],\"slots\":{},\"location\":{\"start\":{\"line\":91},\"end\":{\"line\":92}}},{\"$$mdtype\":\"Node\",\"errors\":[],\"lines\":[91,92],\"inline\":true,\"attributes\":{\"content\":\" seed remote database as well!); whenever you restart your development server (\"},\"children\":[],\"type\":\"text\",\"annotations\":[],\"slots\":{},\"location\":{\"start\":{\"line\":91},\"end\":{\"line\":92}}},{\"$$mdtype\":\"Node\",\"errors\":[],\"lines\":[91,92],\"inline\":true,\"attributes\":{\"content\":\"astro dev\"},\"children\":[],\"type\":\"code\",\"annotations\":[],\"slots\":{},\"location\":{\"start\":{\"line\":91},\"end\":{\"line\":92}}},{\"$$mdtype\":\"Node\",\"errors\":[],\"lines\":[91,92],\"inline\":true,\"attributes\":{\"content\":\"), the database gets reset and re-seeded. How cool is that?!\"},\"children\":[],\"type\":\"text\",\"annotations\":[],\"slots\":{},\"location\":{\"start\":{\"line\":91},\"end\":{\"line\":92}}}],\"type\":\"inline\",\"annotations\":[],\"slots\":{},\"location\":{\"start\":{\"line\":91},\"end\":{\"line\":92}}}],\"type\":\"paragraph\",\"annotations\":[],\"slots\":{},\"location\":{\"start\":{\"line\":91},\"end\":{\"line\":92}}},{\"$$mdtype\":\"Node\",\"errors\":[],\"lines\":[93,94],\"inline\":false,\"attributes\":{},\"children\":[{\"$$mdtype\":\"Node\",\"errors\":[],\"lines\":[93,94],\"inline\":false,\"attributes\":{},\"children\":[{\"$$mdtype\":\"Node\",\"errors\":[],\"lines\":[93,94],\"inline\":true,\"attributes\":{\"content\":\"What's important here is that you now have access to \"},\"children\":[],\"type\":\"text\",\"annotations\":[],\"slots\":{},\"location\":{\"start\":{\"line\":93},\"end\":{\"line\":94}}},{\"$$mdtype\":\"Node\",\"errors\":[],\"lines\":[93,94],\"inline\":true,\"attributes\":{\"content\":\"Visits\"},\"children\":[],\"type\":\"code\",\"annotations\":[],\"slots\":{},\"location\":{\"start\":{\"line\":93},\"end\":{\"line\":94}}},{\"$$mdtype\":\"Node\",\"errors\":[],\"lines\":[93,94],\"inline\":true,\"attributes\":{\"content\":\" and \"},\"children\":[],\"type\":\"text\",\"annotations\":[],\"slots\":{},\"location\":{\"start\":{\"line\":93},\"end\":{\"line\":94}}},{\"$$mdtype\":\"Node\",\"errors\":[],\"lines\":[93,94],\"inline\":true,\"attributes\":{\"content\":\"db\"},\"children\":[],\"type\":\"code\",\"annotations\":[],\"slots\":{},\"location\":{\"start\":{\"line\":93},\"end\":{\"line\":94}}},{\"$$mdtype\":\"Node\",\"errors\":[],\"lines\":[93,94],\"inline\":true,\"attributes\":{\"content\":\" anywhere in your project, and can just use them right away!\"},\"children\":[],\"type\":\"text\",\"annotations\":[],\"slots\":{},\"location\":{\"start\":{\"line\":93},\"end\":{\"line\":94}}}],\"type\":\"inline\",\"annotations\":[],\"slots\":{},\"location\":{\"start\":{\"line\":93},\"end\":{\"line\":94}}}],\"type\":\"paragraph\",\"annotations\":[],\"slots\":{},\"location\":{\"start\":{\"line\":93},\"end\":{\"line\":94}}},{\"$$mdtype\":\"Node\",\"errors\":[],\"lines\":[95,96],\"inline\":false,\"attributes\":{\"level\":3},\"children\":[{\"$$mdtype\":\"Node\",\"errors\":[],\"lines\":[95,96],\"inline\":false,\"attributes\":{},\"children\":[{\"$$mdtype\":\"Node\",\"errors\":[],\"lines\":[95,96],\"inline\":true,\"attributes\":{\"content\":\"Accessing Astro Studio\"},\"children\":[],\"type\":\"text\",\"annotations\":[],\"slots\":{},\"location\":{\"start\":{\"line\":95},\"end\":{\"line\":96}}}],\"type\":\"inline\",\"annotations\":[],\"slots\":{},\"location\":{\"start\":{\"line\":95},\"end\":{\"line\":96}}}],\"type\":\"heading\",\"annotations\":[],\"slots\":{},\"location\":{\"start\":{\"line\":95},\"end\":{\"line\":96}}},{\"$$mdtype\":\"Node\",\"errors\":[],\"lines\":[97,98],\"inline\":false,\"attributes\":{},\"children\":[{\"$$mdtype\":\"Node\",\"errors\":[],\"lines\":[97,98],\"inline\":false,\"attributes\":{},\"children\":[{\"$$mdtype\":\"Node\",\"errors\":[],\"lines\":[97,98],\"inline\":true,\"attributes\":{\"content\":\"Before moving forward with the views counter implementation, let me quickly note a few things about local and remote databases.\"},\"children\":[],\"type\":\"text\",\"annotations\":[],\"slots\":{},\"location\":{\"start\":{\"line\":97},\"end\":{\"line\":98}}}],\"type\":\"inline\",\"annotations\":[],\"slots\":{},\"location\":{\"start\":{\"line\":97},\"end\":{\"line\":98}}}],\"type\":\"paragraph\",\"annotations\":[],\"slots\":{},\"location\":{\"start\":{\"line\":97},\"end\":{\"line\":98}}},{\"$$mdtype\":\"Node\",\"errors\":[],\"lines\":[99,100],\"inline\":false,\"attributes\":{},\"children\":[{\"$$mdtype\":\"Node\",\"errors\":[],\"lines\":[99,100],\"inline\":false,\"attributes\":{},\"children\":[{\"$$mdtype\":\"Node\",\"errors\":[],\"lines\":[99,100],\"inline\":true,\"attributes\":{\"content\":\"When you develop locally, the database is reset every time you restart the development server.\"},\"children\":[],\"type\":\"text\",\"annotations\":[],\"slots\":{},\"location\":{\"start\":{\"line\":99},\"end\":{\"line\":100}}}],\"type\":\"inline\",\"annotations\":[],\"slots\":{},\"location\":{\"start\":{\"line\":99},\"end\":{\"line\":100}}}],\"type\":\"paragraph\",\"annotations\":[],\"slots\":{},\"location\":{\"start\":{\"line\":99},\"end\":{\"line\":100}}},{\"$$mdtype\":\"Node\",\"errors\":[],\"lines\":[101,102],\"inline\":false,\"attributes\":{},\"children\":[{\"$$mdtype\":\"Node\",\"errors\":[],\"lines\":[101,102],\"inline\":false,\"attributes\":{},\"children\":[{\"$$mdtype\":\"Node\",\"errors\":[],\"lines\":[101,102],\"inline\":true,\"attributes\":{\"content\":\"When you're happy with the schema, you can push this schema to the remote database, the one that's going to be used when you deploy your project. The CLI is pretty straightforward here: you login to Astro Studio, link your local database to a (new) project, push local changes to this remote DB.\"},\"children\":[],\"type\":\"text\",\"annotations\":[],\"slots\":{},\"location\":{\"start\":{\"line\":101},\"end\":{\"line\":102}}}],\"type\":\"inline\",\"annotations\":[],\"slots\":{},\"location\":{\"start\":{\"line\":101},\"end\":{\"line\":102}}}],\"type\":\"paragraph\",\"annotations\":[],\"slots\":{},\"location\":{\"start\":{\"line\":101},\"end\":{\"line\":102}}},{\"$$mdtype\":\"Node\",\"errors\":[],\"lines\":[103,110],\"inline\":false,\"attributes\":{\"content\":\"astro db login # Follow prompts, login with Github\\n\\nastro db link # Again, follow prompts, create a new project or link local db to an existing one\\n\\nastro db push # Tell the remote DB what you want it to look like\\n\",\"language\":\"sh\"},\"children\":[{\"$$mdtype\":\"Node\",\"errors\":[],\"lines\":[103,110],\"inline\":false,\"attributes\":{\"content\":\"astro db login # Follow prompts, login with Github\\n\\nastro db link # Again, follow prompts, create a new project or link local db to an existing one\\n\\nastro db push # Tell the remote DB what you want it to look like\\n\"},\"children\":[],\"type\":\"text\",\"annotations\":[],\"slots\":{},\"location\":{\"start\":{\"line\":103},\"end\":{\"line\":110}}}],\"type\":\"fence\",\"annotations\":[],\"slots\":{},\"location\":{\"start\":{\"line\":103},\"end\":{\"line\":110}}},{\"$$mdtype\":\"Node\",\"errors\":[],\"lines\":[111,112],\"inline\":false,\"attributes\":{},\"children\":[{\"$$mdtype\":\"Node\",\"errors\":[],\"lines\":[111,112],\"inline\":false,\"attributes\":{},\"children\":[{\"$$mdtype\":\"Node\",\"errors\":[],\"lines\":[111,112],\"inline\":true,\"attributes\":{\"content\":\"As an added feature, you could also seed the remote database:\"},\"children\":[],\"type\":\"text\",\"annotations\":[],\"slots\":{},\"location\":{\"start\":{\"line\":111},\"end\":{\"line\":112}}}],\"type\":\"inline\",\"annotations\":[],\"slots\":{},\"location\":{\"start\":{\"line\":111},\"end\":{\"line\":112}}}],\"type\":\"paragraph\",\"annotations\":[],\"slots\":{},\"location\":{\"start\":{\"line\":111},\"end\":{\"line\":112}}},{\"$$mdtype\":\"Node\",\"errors\":[],\"lines\":[113,116],\"inline\":false,\"attributes\":{\"content\":\"astro db execute db/seed.ts --remote # \\\"db/seed.ts\\\" here is just a path to the file where your seed data is.\\n\",\"language\":\"sh\"},\"children\":[{\"$$mdtype\":\"Node\",\"errors\":[],\"lines\":[113,116],\"inline\":false,\"attributes\":{\"content\":\"astro db execute db/seed.ts --remote # \\\"db/seed.ts\\\" here is just a path to the file where your seed data is.\\n\"},\"children\":[],\"type\":\"text\",\"annotations\":[],\"slots\":{},\"location\":{\"start\":{\"line\":113},\"end\":{\"line\":116}}}],\"type\":\"fence\",\"annotations\":[],\"slots\":{},\"location\":{\"start\":{\"line\":113},\"end\":{\"line\":116}}},{\"$$mdtype\":\"Node\",\"errors\":[],\"lines\":[117,118],\"inline\":false,\"attributes\":{},\"children\":[{\"$$mdtype\":\"Node\",\"errors\":[],\"lines\":[117,118],\"inline\":false,\"attributes\":{},\"children\":[{\"$$mdtype\":\"Node\",\"errors\":[],\"lines\":[117,118],\"inline\":true,\"attributes\":{\"content\":\"Oh, and you \"},\"children\":[],\"type\":\"text\",\"annotations\":[],\"slots\":{},\"location\":{\"start\":{\"line\":117},\"end\":{\"line\":118}}},{\"$$mdtype\":\"Node\",\"errors\":[],\"lines\":[117,118],\"inline\":true,\"attributes\":{\"marker\":\"_\"},\"children\":[{\"$$mdtype\":\"Node\",\"errors\":[],\"lines\":[117,118],\"inline\":true,\"attributes\":{\"content\":\"can\"},\"children\":[],\"type\":\"text\",\"annotations\":[],\"slots\":{},\"location\":{\"start\":{\"line\":117},\"end\":{\"line\":118}}}],\"type\":\"em\",\"annotations\":[],\"slots\":{},\"location\":{\"start\":{\"line\":117},\"end\":{\"line\":118}}},{\"$$mdtype\":\"Node\",\"errors\":[],\"lines\":[117,118],\"inline\":true,\"attributes\":{\"content\":\" use the remote database locally! Just be \"},\"children\":[],\"type\":\"text\",\"annotations\":[],\"slots\":{},\"location\":{\"start\":{\"line\":117},\"end\":{\"line\":118}}},{\"$$mdtype\":\"Node\",\"errors\":[],\"lines\":[117,118],\"inline\":true,\"attributes\":{\"marker\":\"_\"},\"children\":[{\"$$mdtype\":\"Node\",\"errors\":[],\"lines\":[117,118],\"inline\":true,\"attributes\":{\"content\":\"very\"},\"children\":[],\"type\":\"text\",\"annotations\":[],\"slots\":{},\"location\":{\"start\":{\"line\":117},\"end\":{\"line\":118}}}],\"type\":\"em\",\"annotations\":[],\"slots\":{},\"location\":{\"start\":{\"line\":117},\"end\":{\"line\":118}}},{\"$$mdtype\":\"Node\",\"errors\":[],\"lines\":[117,118],\"inline\":true,\"attributes\":{\"content\":\" careful.\"},\"children\":[],\"type\":\"text\",\"annotations\":[],\"slots\":{},\"location\":{\"start\":{\"line\":117},\"end\":{\"line\":118}}}],\"type\":\"inline\",\"annotations\":[],\"slots\":{},\"location\":{\"start\":{\"line\":117},\"end\":{\"line\":118}}}],\"type\":\"paragraph\",\"annotations\":[],\"slots\":{},\"location\":{\"start\":{\"line\":117},\"end\":{\"line\":118}}},{\"$$mdtype\":\"Node\",\"errors\":[],\"lines\":[119,122],\"inline\":false,\"attributes\":{\"content\":\"astro dev --remote\\n\",\"language\":\"sh\"},\"children\":[{\"$$mdtype\":\"Node\",\"errors\":[],\"lines\":[119,122],\"inline\":false,\"attributes\":{\"content\":\"astro dev --remote\\n\"},\"children\":[],\"type\":\"text\",\"annotations\":[],\"slots\":{},\"location\":{\"start\":{\"line\":119},\"end\":{\"line\":122}}}],\"type\":\"fence\",\"annotations\":[],\"slots\":{},\"location\":{\"start\":{\"line\":119},\"end\":{\"line\":122}}},{\"$$mdtype\":\"Node\",\"errors\":[],\"lines\":[123,124],\"inline\":false,\"attributes\":{},\"children\":[{\"$$mdtype\":\"Node\",\"errors\":[],\"lines\":[123,124],\"inline\":false,\"attributes\":{},\"children\":[{\"$$mdtype\":\"Node\",\"errors\":[],\"lines\":[123,124],\"inline\":true,\"attributes\":{\"content\":\"Now, go to \"},\"children\":[],\"type\":\"text\",\"annotations\":[],\"slots\":{},\"location\":{\"start\":{\"line\":123},\"end\":{\"line\":124}}},{\"$$mdtype\":\"Node\",\"errors\":[],\"lines\":[123,124],\"inline\":true,\"attributes\":{\"href\":\"https://studio.astro.build/\"},\"children\":[{\"$$mdtype\":\"Node\",\"errors\":[],\"lines\":[123,124],\"inline\":true,\"attributes\":{\"content\":\"Astro Studio\"},\"children\":[],\"type\":\"text\",\"annotations\":[],\"slots\":{},\"location\":{\"start\":{\"line\":123},\"end\":{\"line\":124}}}],\"type\":\"link\",\"annotations\":[],\"slots\":{},\"location\":{\"start\":{\"line\":123},\"end\":{\"line\":124}}},{\"$$mdtype\":\"Node\",\"errors\":[],\"lines\":[123,124],\"inline\":true,\"attributes\":{\"content\":\", log in, and click around. You'll see your new project and its database. Notice, that I have \"},\"children\":[],\"type\":\"text\",\"annotations\":[],\"slots\":{},\"location\":{\"start\":{\"line\":123},\"end\":{\"line\":124}}},{\"$$mdtype\":\"Node\",\"errors\":[],\"lines\":[123,124],\"inline\":true,\"attributes\":{\"content\":\"SQL Console\"},\"children\":[],\"type\":\"code\",\"annotations\":[],\"slots\":{},\"location\":{\"start\":{\"line\":123},\"end\":{\"line\":124}}},{\"$$mdtype\":\"Node\",\"errors\":[],\"lines\":[123,124],\"inline\":true,\"attributes\":{\"content\":\" enabled: if you need to just run a few SQL commands, it's a nice thing to have.\"},\"children\":[],\"type\":\"text\",\"annotations\":[],\"slots\":{},\"location\":{\"start\":{\"line\":123},\"end\":{\"line\":124}}}],\"type\":\"inline\",\"annotations\":[],\"slots\":{},\"location\":{\"start\":{\"line\":123},\"end\":{\"line\":124}}}],\"type\":\"paragraph\",\"annotations\":[],\"slots\":{},\"location\":{\"start\":{\"line\":123},\"end\":{\"line\":124}}},{\"$$mdtype\":\"Node\",\"errors\":[],\"lines\":[125,126],\"inline\":false,\"attributes\":{},\"children\":[{\"$$mdtype\":\"Node\",\"errors\":[],\"lines\":[125,126],\"inline\":false,\"attributes\":{},\"children\":[{\"$$mdtype\":\"Node\",\"errors\":[],\"lines\":[125,126],\"inline\":true,\"attributes\":{\"alt\":\"Astro Studio UI\",\"src\":\"assets/blog/posts/exploring-astro-db/astro-studio-ui.png\",\"__optimizedSrc\":{\"src\":\"/_astro/astro-studio-ui.la_gR9kj.png\",\"width\":2503,\"height\":1243,\"format\":\"png\",\"fsPath\":\"/home/rosnovsky/code/rosnovsky.us/src/assets/blog/posts/exploring-astro-db/astro-studio-ui.png\"}},\"children\":[],\"type\":\"image\",\"annotations\":[],\"slots\":{},\"location\":{\"start\":{\"line\":125},\"end\":{\"line\":126}}}],\"type\":\"inline\",\"annotations\":[],\"slots\":{},\"location\":{\"start\":{\"line\":125},\"end\":{\"line\":126}}}],\"type\":\"paragraph\",\"annotations\":[],\"slots\":{},\"location\":{\"start\":{\"line\":125},\"end\":{\"line\":126}}},{\"$$mdtype\":\"Node\",\"errors\":[],\"lines\":[127,128],\"inline\":false,\"attributes\":{},\"children\":[{\"$$mdtype\":\"Node\",\"errors\":[],\"lines\":[127,128],\"inline\":false,\"attributes\":{},\"children\":[{\"$$mdtype\":\"Node\",\"errors\":[],\"lines\":[127,128],\"inline\":true,\"attributes\":{\"content\":\"As you can see, Astro Studio is pretty limited in what you can see and do there, but it does cover all the bases and again, it's an \\\"Early Preview\\\". What I use Studio the most for is inspecting records, and it does a pretty good job here.\"},\"children\":[],\"type\":\"text\",\"annotations\":[],\"slots\":{},\"location\":{\"start\":{\"line\":127},\"end\":{\"line\":128}}}],\"type\":\"inline\",\"annotations\":[],\"slots\":{},\"location\":{\"start\":{\"line\":127},\"end\":{\"line\":128}}}],\"type\":\"paragraph\",\"annotations\":[],\"slots\":{},\"location\":{\"start\":{\"line\":127},\"end\":{\"line\":128}}},{\"$$mdtype\":\"Node\",\"errors\":[],\"lines\":[129,130],\"inline\":false,\"attributes\":{},\"children\":[{\"$$mdtype\":\"Node\",\"errors\":[],\"lines\":[129,130],\"inline\":false,\"attributes\":{},\"children\":[{\"$$mdtype\":\"Node\",\"errors\":[],\"lines\":[129,130],\"inline\":true,\"attributes\":{\"alt\":\"Astro Studio database UI\",\"src\":\"assets/blog/posts/exploring-astro-db/astro-studio-db-ui.png\",\"__optimizedSrc\":{\"src\":\"/_astro/astro-studio-db-ui.CyoDxx5B.png\",\"width\":3764,\"height\":1785,\"format\":\"png\",\"fsPath\":\"/home/rosnovsky/code/rosnovsky.us/src/assets/blog/posts/exploring-astro-db/astro-studio-db-ui.png\"}},\"children\":[],\"type\":\"image\",\"annotations\":[],\"slots\":{},\"location\":{\"start\":{\"line\":129},\"end\":{\"line\":130}}}],\"type\":\"inline\",\"annotations\":[],\"slots\":{},\"location\":{\"start\":{\"line\":129},\"end\":{\"line\":130}}}],\"type\":\"paragraph\",\"annotations\":[],\"slots\":{},\"location\":{\"start\":{\"line\":129},\"end\":{\"line\":130}}},{\"$$mdtype\":\"Node\",\"errors\":[],\"lines\":[132,133],\"inline\":false,\"attributes\":{\"level\":3},\"children\":[{\"$$mdtype\":\"Node\",\"errors\":[],\"lines\":[132,133],\"inline\":false,\"attributes\":{},\"children\":[{\"$$mdtype\":\"Node\",\"errors\":[],\"lines\":[132,133],\"inline\":true,\"attributes\":{\"content\":\"Implementation\"},\"children\":[],\"type\":\"text\",\"annotations\":[],\"slots\":{},\"location\":{\"start\":{\"line\":132},\"end\":{\"line\":133}}}],\"type\":\"inline\",\"annotations\":[],\"slots\":{},\"location\":{\"start\":{\"line\":132},\"end\":{\"line\":133}}}],\"type\":\"heading\",\"annotations\":[],\"slots\":{},\"location\":{\"start\":{\"line\":132},\"end\":{\"line\":133}}},{\"$$mdtype\":\"Node\",\"errors\":[],\"lines\":[134,135],\"inline\":false,\"attributes\":{},\"children\":[{\"$$mdtype\":\"Node\",\"errors\":[],\"lines\":[134,135],\"inline\":false,\"attributes\":{},\"children\":[{\"$$mdtype\":\"Node\",\"errors\":[],\"lines\":[134,135],\"inline\":true,\"attributes\":{\"content\":\"Aaaanyway, after I got my Astro DB all set up, I got to the actual implementation of the page views counter. I don't want to bore you with the details that are \"},\"children\":[],\"type\":\"text\",\"annotations\":[],\"slots\":{},\"location\":{\"start\":{\"line\":134},\"end\":{\"line\":135}}},{\"$$mdtype\":\"Node\",\"errors\":[],\"lines\":[134,135],\"inline\":true,\"attributes\":{\"marker\":\"_\"},\"children\":[{\"$$mdtype\":\"Node\",\"errors\":[],\"lines\":[134,135],\"inline\":true,\"attributes\":{\"content\":\"very\"},\"children\":[],\"type\":\"text\",\"annotations\":[],\"slots\":{},\"location\":{\"start\":{\"line\":134},\"end\":{\"line\":135}}}],\"type\":\"em\",\"annotations\":[],\"slots\":{},\"location\":{\"start\":{\"line\":134},\"end\":{\"line\":135}}},{\"$$mdtype\":\"Node\",\"errors\":[],\"lines\":[134,135],\"inline\":true,\"attributes\":{\"content\":\" specific to my particular website, so I'd boil it down to more generic steps.\"},\"children\":[],\"type\":\"text\",\"annotations\":[],\"slots\":{},\"location\":{\"start\":{\"line\":134},\"end\":{\"line\":135}}}],\"type\":\"inline\",\"annotations\":[],\"slots\":{},\"location\":{\"start\":{\"line\":134},\"end\":{\"line\":135}}}],\"type\":\"paragraph\",\"annotations\":[],\"slots\":{},\"location\":{\"start\":{\"line\":134},\"end\":{\"line\":135}}},{\"$$mdtype\":\"Node\",\"errors\":[],\"lines\":[136,137],\"inline\":false,\"attributes\":{},\"children\":[{\"$$mdtype\":\"Node\",\"errors\":[],\"lines\":[136,137],\"inline\":false,\"attributes\":{},\"children\":[{\"$$mdtype\":\"Node\",\"errors\":[],\"lines\":[136,137],\"inline\":true,\"attributes\":{\"content\":\"The first step is to figure out how we are going to register visits. There are multiple ways to approach this depending on what Astro \"},\"children\":[],\"type\":\"text\",\"annotations\":[],\"slots\":{},\"location\":{\"start\":{\"line\":136},\"end\":{\"line\":137}}},{\"$$mdtype\":\"Node\",\"errors\":[],\"lines\":[136,137],\"inline\":true,\"attributes\":{\"href\":\"https://docs.astro.build/en/basics/rendering-modes/\"},\"children\":[{\"$$mdtype\":\"Node\",\"errors\":[],\"lines\":[136,137],\"inline\":true,\"attributes\":{\"content\":\"rendering \"},\"children\":[],\"type\":\"text\",\"annotations\":[],\"slots\":{},\"location\":{\"start\":{\"line\":136},\"end\":{\"line\":137}}},{\"$$mdtype\":\"Node\",\"errors\":[],\"lines\":[136,137],\"inline\":true,\"attributes\":{\"content\":\"mode\"},\"children\":[],\"type\":\"code\",\"annotations\":[],\"slots\":{},\"location\":{\"start\":{\"line\":136},\"end\":{\"line\":137}}}],\"type\":\"link\",\"annotations\":[],\"slots\":{},\"location\":{\"start\":{\"line\":136},\"end\":{\"line\":137}}},{\"$$mdtype\":\"Node\",\"errors\":[],\"lines\":[136,137],\"inline\":true,\"attributes\":{\"content\":\" you're using:\"},\"children\":[],\"type\":\"text\",\"annotations\":[],\"slots\":{},\"location\":{\"start\":{\"line\":136},\"end\":{\"line\":137}}}],\"type\":\"inline\",\"annotations\":[],\"slots\":{},\"location\":{\"start\":{\"line\":136},\"end\":{\"line\":137}}}],\"type\":\"paragraph\",\"annotations\":[],\"slots\":{},\"location\":{\"start\":{\"line\":136},\"end\":{\"line\":137}}},{\"$$mdtype\":\"Node\",\"errors\":[],\"lines\":[138,141],\"inline\":false,\"attributes\":{\"ordered\":false,\"marker\":\"-\"},\"children\":[{\"$$mdtype\":\"Node\",\"errors\":[],\"lines\":[138,139],\"inline\":false,\"attributes\":{},\"children\":[{\"$$mdtype\":\"Node\",\"errors\":[],\"lines\":[138,139],\"inline\":false,\"attributes\":{},\"children\":[{\"$$mdtype\":\"Node\",\"errors\":[],\"lines\":[138,139],\"inline\":true,\"attributes\":{\"content\":\"in \"},\"children\":[],\"type\":\"text\",\"annotations\":[],\"slots\":{},\"location\":{\"start\":{\"line\":138},\"end\":{\"line\":139}}},{\"$$mdtype\":\"Node\",\"errors\":[],\"lines\":[138,139],\"inline\":true,\"attributes\":{\"content\":\"static\"},\"children\":[],\"type\":\"code\",\"annotations\":[],\"slots\":{},\"location\":{\"start\":{\"line\":138},\"end\":{\"line\":139}}},{\"$$mdtype\":\"Node\",\"errors\":[],\"lines\":[138,139],\"inline\":true,\"attributes\":{\"content\":\" or \"},\"children\":[],\"type\":\"text\",\"annotations\":[],\"slots\":{},\"location\":{\"start\":{\"line\":138},\"end\":{\"line\":139}}},{\"$$mdtype\":\"Node\",\"errors\":[],\"lines\":[138,139],\"inline\":true,\"attributes\":{\"content\":\"hybrid\"},\"children\":[],\"type\":\"code\",\"annotations\":[],\"slots\":{},\"location\":{\"start\":{\"line\":138},\"end\":{\"line\":139}}},{\"$$mdtype\":\"Node\",\"errors\":[],\"lines\":[138,139],\"inline\":true,\"attributes\":{\"content\":\" mode, you could load a counter \"},\"children\":[],\"type\":\"text\",\"annotations\":[],\"slots\":{},\"location\":{\"start\":{\"line\":138},\"end\":{\"line\":139}}},{\"$$mdtype\":\"Node\",\"errors\":[],\"lines\":[138,139],\"inline\":true,\"attributes\":{\"content\":\"pixel\"},\"children\":[],\"type\":\"code\",\"annotations\":[],\"slots\":{},\"location\":{\"start\":{\"line\":138},\"end\":{\"line\":139}}},{\"$$mdtype\":\"Node\",\"errors\":[],\"lines\":[138,139],\"inline\":true,\"attributes\":{\"content\":\" (a 1x1 pixel image pointing to an \"},\"children\":[],\"type\":\"text\",\"annotations\":[],\"slots\":{},\"location\":{\"start\":{\"line\":138},\"end\":{\"line\":139}}},{\"$$mdtype\":\"Node\",\"errors\":[],\"lines\":[138,139],\"inline\":true,\"attributes\":{\"href\":\"https://docs.astro.build/en/guides/endpoints/\"},\"children\":[{\"$$mdtype\":\"Node\",\"errors\":[],\"lines\":[138,139],\"inline\":true,\"attributes\":{\"content\":\"endpoint\"},\"children\":[],\"type\":\"text\",\"annotations\":[],\"slots\":{},\"location\":{\"start\":{\"line\":138},\"end\":{\"line\":139}}}],\"type\":\"link\",\"annotations\":[],\"slots\":{},\"location\":{\"start\":{\"line\":138},\"end\":{\"line\":139}}},{\"$$mdtype\":\"Node\",\"errors\":[],\"lines\":[138,139],\"inline\":true,\"attributes\":{\"content\":\")\"},\"children\":[],\"type\":\"text\",\"annotations\":[],\"slots\":{},\"location\":{\"start\":{\"line\":138},\"end\":{\"line\":139}}}],\"type\":\"inline\",\"annotations\":[],\"slots\":{},\"location\":{\"start\":{\"line\":138},\"end\":{\"line\":139}}}],\"type\":\"item\",\"annotations\":[],\"slots\":{},\"location\":{\"start\":{\"line\":138},\"end\":{\"line\":139}}},{\"$$mdtype\":\"Node\",\"errors\":[],\"lines\":[139,141],\"inline\":false,\"attributes\":{},\"children\":[{\"$$mdtype\":\"Node\",\"errors\":[],\"lines\":[139,140],\"inline\":false,\"attributes\":{},\"children\":[{\"$$mdtype\":\"Node\",\"errors\":[],\"lines\":[139,140],\"inline\":true,\"attributes\":{\"content\":\"in \"},\"children\":[],\"type\":\"text\",\"annotations\":[],\"slots\":{},\"location\":{\"start\":{\"line\":139},\"end\":{\"line\":140}}},{\"$$mdtype\":\"Node\",\"errors\":[],\"lines\":[139,140],\"inline\":true,\"attributes\":{\"content\":\"server\"},\"children\":[],\"type\":\"code\",\"annotations\":[],\"slots\":{},\"location\":{\"start\":{\"line\":139},\"end\":{\"line\":140}}},{\"$$mdtype\":\"Node\",\"errors\":[],\"lines\":[139,140],\"inline\":true,\"attributes\":{\"content\":\" or \"},\"children\":[],\"type\":\"text\",\"annotations\":[],\"slots\":{},\"location\":{\"start\":{\"line\":139},\"end\":{\"line\":140}}},{\"$$mdtype\":\"Node\",\"errors\":[],\"lines\":[139,140],\"inline\":true,\"attributes\":{\"content\":\"hybrid\"},\"children\":[],\"type\":\"code\",\"annotations\":[],\"slots\":{},\"location\":{\"start\":{\"line\":139},\"end\":{\"line\":140}}},{\"$$mdtype\":\"Node\",\"errors\":[],\"lines\":[139,140],\"inline\":true,\"attributes\":{\"content\":\" mode with \"},\"children\":[],\"type\":\"text\",\"annotations\":[],\"slots\":{},\"location\":{\"start\":{\"line\":139},\"end\":{\"line\":140}}},{\"$$mdtype\":\"Node\",\"errors\":[],\"lines\":[139,140],\"inline\":true,\"attributes\":{\"content\":\"export const prerender = false\"},\"children\":[],\"type\":\"code\",\"annotations\":[],\"slots\":{},\"location\":{\"start\":{\"line\":139},\"end\":{\"line\":140}}},{\"$$mdtype\":\"Node\",\"errors\":[],\"lines\":[139,140],\"inline\":true,\"attributes\":{\"content\":\", you could make a call directly to the endpoint that counts visits\"},\"children\":[],\"type\":\"text\",\"annotations\":[],\"slots\":{},\"location\":{\"start\":{\"line\":139},\"end\":{\"line\":140}}}],\"type\":\"inline\",\"annotations\":[],\"slots\":{},\"location\":{\"start\":{\"line\":139},\"end\":{\"line\":140}}}],\"type\":\"item\",\"annotations\":[],\"slots\":{},\"location\":{\"start\":{\"line\":139},\"end\":{\"line\":141}}}],\"type\":\"list\",\"annotations\":[],\"slots\":{},\"location\":{\"start\":{\"line\":138},\"end\":{\"line\":141}}},{\"$$mdtype\":\"Node\",\"errors\":[],\"lines\":[141,142],\"inline\":false,\"attributes\":{},\"children\":[{\"$$mdtype\":\"Node\",\"errors\":[],\"lines\":[141,142],\"inline\":false,\"attributes\":{},\"children\":[{\"$$mdtype\":\"Node\",\"errors\":[],\"lines\":[141,142],\"inline\":true,\"attributes\":{\"content\":\"My website is primarily static; I use \"},\"children\":[],\"type\":\"text\",\"annotations\":[],\"slots\":{},\"location\":{\"start\":{\"line\":141},\"end\":{\"line\":142}}},{\"$$mdtype\":\"Node\",\"errors\":[],\"lines\":[141,142],\"inline\":true,\"attributes\":{\"content\":\"hybrid\"},\"children\":[],\"type\":\"code\",\"annotations\":[],\"slots\":{},\"location\":{\"start\":{\"line\":141},\"end\":{\"line\":142}}},{\"$$mdtype\":\"Node\",\"errors\":[],\"lines\":[141,142],\"inline\":true,\"attributes\":{\"content\":\" mode so that I do have an option to disable prerendering when I need to. It actually poses some quite specific challenges that I won't go into here, but just keep this in mind: if something doesn't work the way you expect it to work, check your rendering mode first :)\"},\"children\":[],\"type\":\"text\",\"annotations\":[],\"slots\":{},\"location\":{\"start\":{\"line\":141},\"end\":{\"line\":142}}}],\"type\":\"inline\",\"annotations\":[],\"slots\":{},\"location\":{\"start\":{\"line\":141},\"end\":{\"line\":142}}}],\"type\":\"paragraph\",\"annotations\":[],\"slots\":{},\"location\":{\"start\":{\"line\":141},\"end\":{\"line\":142}}},{\"$$mdtype\":\"Node\",\"errors\":[],\"lines\":[143,144],\"inline\":false,\"attributes\":{},\"children\":[{\"$$mdtype\":\"Node\",\"errors\":[],\"lines\":[143,144],\"inline\":false,\"attributes\":{},\"children\":[{\"$$mdtype\":\"Node\",\"errors\":[],\"lines\":[143,144],\"inline\":true,\"attributes\":{\"content\":\"I've added my \"},\"children\":[],\"type\":\"text\",\"annotations\":[],\"slots\":{},\"location\":{\"start\":{\"line\":143},\"end\":{\"line\":144}}},{\"$$mdtype\":\"Node\",\"errors\":[],\"lines\":[143,144],\"inline\":true,\"attributes\":{\"content\":\"pixel\"},\"children\":[],\"type\":\"code\",\"annotations\":[],\"slots\":{},\"location\":{\"start\":{\"line\":143},\"end\":{\"line\":144}}},{\"$$mdtype\":\"Node\",\"errors\":[],\"lines\":[143,144],\"inline\":true,\"attributes\":{\"content\":\" to the footer of my site along with a \"},\"children\":[],\"type\":\"text\",\"annotations\":[],\"slots\":{},\"location\":{\"start\":{\"line\":143},\"end\":{\"line\":144}}},{\"$$mdtype\":\"Node\",\"errors\":[],\"lines\":[143,144],\"inline\":true,\"attributes\":{\"content\":\"Views\"},\"children\":[],\"type\":\"code\",\"annotations\":[],\"slots\":{},\"location\":{\"start\":{\"line\":143},\"end\":{\"line\":144}}},{\"$$mdtype\":\"Node\",\"errors\":[],\"lines\":[143,144],\"inline\":true,\"attributes\":{\"content\":\" component:\"},\"children\":[],\"type\":\"text\",\"annotations\":[],\"slots\":{},\"location\":{\"start\":{\"line\":143},\"end\":{\"line\":144}}}],\"type\":\"inline\",\"annotations\":[],\"slots\":{},\"location\":{\"start\":{\"line\":143},\"end\":{\"line\":144}}}],\"type\":\"paragraph\",\"annotations\":[],\"slots\":{},\"location\":{\"start\":{\"line\":143},\"end\":{\"line\":144}}},{\"$$mdtype\":\"Node\",\"errors\":[],\"lines\":[145,161],\"inline\":false,\"attributes\":{\"content\":\"// Footer.astro\\n---\\nconst currentPage = Astro.url.pathname.split('/') // naive \\\"give me the current page url\\\" kind of thing\\ncurrentPage.shift() // oh, and remove the leading `/`\\n---\\n\\n<Image\\n  src={`/visitors/register.png?page=${currentPage}`}\\n  loading=\\\"eager\\\"\\n  aria-hidden=\\\"true\\\"\\n  alt=\\\"tracking pixel\\\"\\n  width=\\\"1\\\"\\n  height=\\\"1\\\" />\\n<Views client:only currentPage={currentPage} />\\n\",\"language\":\"tsx\"},\"children\":[{\"$$mdtype\":\"Node\",\"errors\":[],\"lines\":[145,161],\"inline\":false,\"attributes\":{\"content\":\"// Footer.astro\\n---\\nconst currentPage = Astro.url.pathname.split('/') // naive \\\"give me the current page url\\\" kind of thing\\ncurrentPage.shift() // oh, and remove the leading `/`\\n---\\n\\n<Image\\n  src={`/visitors/register.png?page=${currentPage}`}\\n  loading=\\\"eager\\\"\\n  aria-hidden=\\\"true\\\"\\n  alt=\\\"tracking pixel\\\"\\n  width=\\\"1\\\"\\n  height=\\\"1\\\" />\\n<Views client:only currentPage={currentPage} />\\n\"},\"children\":[],\"type\":\"text\",\"annotations\":[],\"slots\":{},\"location\":{\"start\":{\"line\":145},\"end\":{\"line\":161}}}],\"type\":\"fence\",\"annotations\":[],\"slots\":{},\"location\":{\"start\":{\"line\":145},\"end\":{\"line\":161}}},{\"$$mdtype\":\"Node\",\"errors\":[],\"lines\":[162,163],\"inline\":false,\"attributes\":{},\"children\":[{\"$$mdtype\":\"Node\",\"errors\":[],\"lines\":[162,163],\"inline\":false,\"attributes\":{},\"children\":[{\"$$mdtype\":\"Node\",\"errors\":[],\"lines\":[162,163],\"inline\":true,\"attributes\":{\"content\":\"Now, I just need to actually register visits. That's where the magic happens!\"},\"children\":[],\"type\":\"text\",\"annotations\":[],\"slots\":{},\"location\":{\"start\":{\"line\":162},\"end\":{\"line\":163}}}],\"type\":\"inline\",\"annotations\":[],\"slots\":{},\"location\":{\"start\":{\"line\":162},\"end\":{\"line\":163}}}],\"type\":\"paragraph\",\"annotations\":[],\"slots\":{},\"location\":{\"start\":{\"line\":162},\"end\":{\"line\":163}}},{\"$$mdtype\":\"Node\",\"errors\":[],\"lines\":[164,246],\"inline\":false,\"attributes\":{\"content\":\"// src/pages/visitors/register.ts\\n\\nexport const prerender = false;\\n\\nimport crypto from 'node:crypto';\\nimport { db, Visits, eq, and } from 'astro:db';\\nimport type { APIRoute } from 'astro';\\n\\nexport const GET: APIRoute = async (data) => {\\n  const hash = (data: any) => crypto.createHash('sha256').update(data).digest('hex');\\n\\n  const userAgent: string = data.request.headers.get('User-Agent') || '';\\n  const ip: string = data.clientAddress;\\n  const pagePathName: string = data.request.url.split('=')[1];\\n\\n  const pagePaths = pagePathName ? pagePathName.split(',') : [];\\n\\n  // This is lazy and dumb, ignore it\\n  let page = \\\"home\\\";\\n  let content = \\\"none\\\";\\n  let pagination = 1;\\n\\n\\n  if (pagePathName.length === 0) {\\n    page = 'home'\\n  } else if (pagePaths.length === 1) {\\n    page = pagePaths[0]\\n  } else if (pagePaths.length === 2) {\\n    page = pagePaths[0]\\n    content = pagePaths[1]\\n  } else if (pagePaths.length === 3) {\\n    page = pagePaths[0]\\n    content = pagePaths[1]\\n    pagination = Number(pagePaths[2])\\n  }\\n  // The end of \\\"this is lazy and dumb, ignore it\\\"\\n\\n  const userAgentHash = hash(userAgent);\\n  const ipHash = hash(ip);\\n\\n  const [visits] = await db\\n    .select()\\n    .from(Visits)\\n    .where(\\n      and(\\n        eq(Visits.visitor_ip_hash, ipHash),\\n        eq(Visits.visitor_user_agent_hash, userAgentHash),\\n        eq(Visits.page, page),\\n        eq(Visits.content, content),\\n        eq(Visits.pagination, pagination)\\n      )\\n    )\\n\\n  if (visits) {\\n    await db\\n      .update(Visits)\\n      .set({\\n        visitor_count: visits.visitor_count + 1\\n        })\\n      .where(\\n        eq(Visits.id, visits.id))\\n  } else {\\n    await db\\n      .insert(Visits)\\n      .values({\\n        page,\\n        content,\\n        pagination,\\n        visitor_ip_hash: ipHash,\\n        visitor_user_agent_hash: userAgentHash\\n    })\\n  }\\n\\n  return new Response(JSON.stringify(visits), {\\n    status: 200,\\n    headers: {\\n      \\\"Content-Type\\\": \\\"application/json\\\"\\n    }\\n  });\\n}\\n\",\"language\":\"ts\"},\"children\":[{\"$$mdtype\":\"Node\",\"errors\":[],\"lines\":[164,246],\"inline\":false,\"attributes\":{\"content\":\"// src/pages/visitors/register.ts\\n\\nexport const prerender = false;\\n\\nimport crypto from 'node:crypto';\\nimport { db, Visits, eq, and } from 'astro:db';\\nimport type { APIRoute } from 'astro';\\n\\nexport const GET: APIRoute = async (data) => {\\n  const hash = (data: any) => crypto.createHash('sha256').update(data).digest('hex');\\n\\n  const userAgent: string = data.request.headers.get('User-Agent') || '';\\n  const ip: string = data.clientAddress;\\n  const pagePathName: string = data.request.url.split('=')[1];\\n\\n  const pagePaths = pagePathName ? pagePathName.split(',') : [];\\n\\n  // This is lazy and dumb, ignore it\\n  let page = \\\"home\\\";\\n  let content = \\\"none\\\";\\n  let pagination = 1;\\n\\n\\n  if (pagePathName.length === 0) {\\n    page = 'home'\\n  } else if (pagePaths.length === 1) {\\n    page = pagePaths[0]\\n  } else if (pagePaths.length === 2) {\\n    page = pagePaths[0]\\n    content = pagePaths[1]\\n  } else if (pagePaths.length === 3) {\\n    page = pagePaths[0]\\n    content = pagePaths[1]\\n    pagination = Number(pagePaths[2])\\n  }\\n  // The end of \\\"this is lazy and dumb, ignore it\\\"\\n\\n  const userAgentHash = hash(userAgent);\\n  const ipHash = hash(ip);\\n\\n  const [visits] = await db\\n    .select()\\n    .from(Visits)\\n    .where(\\n      and(\\n        eq(Visits.visitor_ip_hash, ipHash),\\n        eq(Visits.visitor_user_agent_hash, userAgentHash),\\n        eq(Visits.page, page),\\n        eq(Visits.content, content),\\n        eq(Visits.pagination, pagination)\\n      )\\n    )\\n\\n  if (visits) {\\n    await db\\n      .update(Visits)\\n      .set({\\n        visitor_count: visits.visitor_count + 1\\n        })\\n      .where(\\n        eq(Visits.id, visits.id))\\n  } else {\\n    await db\\n      .insert(Visits)\\n      .values({\\n        page,\\n        content,\\n        pagination,\\n        visitor_ip_hash: ipHash,\\n        visitor_user_agent_hash: userAgentHash\\n    })\\n  }\\n\\n  return new Response(JSON.stringify(visits), {\\n    status: 200,\\n    headers: {\\n      \\\"Content-Type\\\": \\\"application/json\\\"\\n    }\\n  });\\n}\\n\"},\"children\":[],\"type\":\"text\",\"annotations\":[],\"slots\":{},\"location\":{\"start\":{\"line\":164},\"end\":{\"line\":246}}}],\"type\":\"fence\",\"annotations\":[],\"slots\":{},\"location\":{\"start\":{\"line\":164},\"end\":{\"line\":246}}},{\"$$mdtype\":\"Node\",\"errors\":[],\"lines\":[247,248],\"inline\":false,\"attributes\":{},\"children\":[{\"$$mdtype\":\"Node\",\"errors\":[],\"lines\":[247,248],\"inline\":false,\"attributes\":{},\"children\":[{\"$$mdtype\":\"Node\",\"errors\":[],\"lines\":[247,248],\"inline\":true,\"attributes\":{\"content\":\"I first check if a visit from this prticular visitor to this specific page has been registered already, and if so, I increase the count (I should also be checking for a timestamp here, come to think of it). If it's a brand new visit, I do \"},\"children\":[],\"type\":\"text\",\"annotations\":[],\"slots\":{},\"location\":{\"start\":{\"line\":247},\"end\":{\"line\":248}}},{\"$$mdtype\":\"Node\",\"errors\":[],\"lines\":[247,248],\"inline\":true,\"attributes\":{\"content\":\"db.insert\"},\"children\":[],\"type\":\"code\",\"annotations\":[],\"slots\":{},\"location\":{\"start\":{\"line\":247},\"end\":{\"line\":248}}},{\"$$mdtype\":\"Node\",\"errors\":[],\"lines\":[247,248],\"inline\":true,\"attributes\":{\"content\":\".\"},\"children\":[],\"type\":\"text\",\"annotations\":[],\"slots\":{},\"location\":{\"start\":{\"line\":247},\"end\":{\"line\":248}}}],\"type\":\"inline\",\"annotations\":[],\"slots\":{},\"location\":{\"start\":{\"line\":247},\"end\":{\"line\":248}}}],\"type\":\"paragraph\",\"annotations\":[],\"slots\":{},\"location\":{\"start\":{\"line\":247},\"end\":{\"line\":248}}},{\"$$mdtype\":\"Node\",\"errors\":[],\"lines\":[249,250],\"inline\":false,\"attributes\":{},\"children\":[{\"$$mdtype\":\"Node\",\"errors\":[],\"lines\":[249,250],\"inline\":false,\"attributes\":{},\"children\":[{\"$$mdtype\":\"Node\",\"errors\":[],\"lines\":[249,250],\"inline\":true,\"attributes\":{\"content\":\"Now, how do we display the number of view? Here's what my \"},\"children\":[],\"type\":\"text\",\"annotations\":[],\"slots\":{},\"location\":{\"start\":{\"line\":249},\"end\":{\"line\":250}}},{\"$$mdtype\":\"Node\",\"errors\":[],\"lines\":[249,250],\"inline\":true,\"attributes\":{\"content\":\"Views.tsx\"},\"children\":[],\"type\":\"code\",\"annotations\":[],\"slots\":{},\"location\":{\"start\":{\"line\":249},\"end\":{\"line\":250}}},{\"$$mdtype\":\"Node\",\"errors\":[],\"lines\":[249,250],\"inline\":true,\"attributes\":{\"content\":\" looks like. NB: I'd very much prefer for this \\\"dynamic\\\" component to be an Astro component, alas it has to be (p)react (I'm using the official \"},\"children\":[],\"type\":\"text\",\"annotations\":[],\"slots\":{},\"location\":{\"start\":{\"line\":249},\"end\":{\"line\":250}}},{\"$$mdtype\":\"Node\",\"errors\":[],\"lines\":[249,250],\"inline\":true,\"attributes\":{\"href\":\"https://docs.astro.build/en/guides/integrations-guide/preact/\"},\"children\":[{\"$$mdtype\":\"Node\",\"errors\":[],\"lines\":[249,250],\"inline\":true,\"attributes\":{\"content\":\"preact integration\"},\"children\":[],\"type\":\"text\",\"annotations\":[],\"slots\":{},\"location\":{\"start\":{\"line\":249},\"end\":{\"line\":250}}}],\"type\":\"link\",\"annotations\":[],\"slots\":{},\"location\":{\"start\":{\"line\":249},\"end\":{\"line\":250}}},{\"$$mdtype\":\"Node\",\"errors\":[],\"lines\":[249,250],\"inline\":true,\"attributes\":{\"content\":\").\"},\"children\":[],\"type\":\"text\",\"annotations\":[],\"slots\":{},\"location\":{\"start\":{\"line\":249},\"end\":{\"line\":250}}}],\"type\":\"inline\",\"annotations\":[],\"slots\":{},\"location\":{\"start\":{\"line\":249},\"end\":{\"line\":250}}}],\"type\":\"paragraph\",\"annotations\":[],\"slots\":{},\"location\":{\"start\":{\"line\":249},\"end\":{\"line\":250}}},{\"$$mdtype\":\"Node\",\"errors\":[],\"lines\":[251,264],\"inline\":false,\"attributes\":{\"content\":\"// Views.tsx\\nimport { Suspense, lazy } from 'preact/compat'\\nconst ViewsCount = lazy(() => import('./ViewsCount'))\\n\\nexport const Views = ({ currentPage }: { currentPage: string[] }) => {\\n  return (\\n    <Suspense fallback={<div>Loading Views...</div>}>\\n      <ViewsCount currentPage={currentPage} />\\n    </Suspense>\\n  )\\n}\\n\",\"language\":\"tsx\"},\"children\":[{\"$$mdtype\":\"Node\",\"errors\":[],\"lines\":[251,264],\"inline\":false,\"attributes\":{\"content\":\"// Views.tsx\\nimport { Suspense, lazy } from 'preact/compat'\\nconst ViewsCount = lazy(() => import('./ViewsCount'))\\n\\nexport const Views = ({ currentPage }: { currentPage: string[] }) => {\\n  return (\\n    <Suspense fallback={<div>Loading Views...</div>}>\\n      <ViewsCount currentPage={currentPage} />\\n    </Suspense>\\n  )\\n}\\n\"},\"children\":[],\"type\":\"text\",\"annotations\":[],\"slots\":{},\"location\":{\"start\":{\"line\":251},\"end\":{\"line\":264}}}],\"type\":\"fence\",\"annotations\":[],\"slots\":{},\"location\":{\"start\":{\"line\":251},\"end\":{\"line\":264}}},{\"$$mdtype\":\"Node\",\"errors\":[],\"lines\":[265,266],\"inline\":false,\"attributes\":{},\"children\":[{\"$$mdtype\":\"Node\",\"errors\":[],\"lines\":[265,266],\"inline\":false,\"attributes\":{},\"children\":[{\"$$mdtype\":\"Node\",\"errors\":[],\"lines\":[265,266],\"inline\":true,\"attributes\":{\"content\":\"And the actual counter:\"},\"children\":[],\"type\":\"text\",\"annotations\":[],\"slots\":{},\"location\":{\"start\":{\"line\":265},\"end\":{\"line\":266}}}],\"type\":\"inline\",\"annotations\":[],\"slots\":{},\"location\":{\"start\":{\"line\":265},\"end\":{\"line\":266}}}],\"type\":\"paragraph\",\"annotations\":[],\"slots\":{},\"location\":{\"start\":{\"line\":265},\"end\":{\"line\":266}}},{\"$$mdtype\":\"Node\",\"errors\":[],\"lines\":[267,293],\"inline\":false,\"attributes\":{\"content\":\"// ViewsCount.tsx\\n\\nimport { useEffect, useState } from 'react'\\n\\nconst ViewsCount = ({ currentPage }: { currentPage: string[] }): JSX.Element => {\\n  const [views, setViews] = useState()\\n\\n  useEffect(() => {\\n    const fetchViews = async () => {\\n      const visitsData = await fetch(`/visitors/count?${currentPage}`)\\n      const visits = await visitsData.json()\\n\\n      setViews(visits)\\n    }\\n\\n    fetchViews()\\n  }, [currentPage])\\n\\n  return (\\n    <span className=\\\"mt-8 text-base text-slate-400/90 md:mt-0\\\">Views: {views}</span>\\n  );\\n}\\n\\nexport default ViewsCount;\\n\",\"language\":\"tsx\"},\"children\":[{\"$$mdtype\":\"Node\",\"errors\":[],\"lines\":[267,293],\"inline\":false,\"attributes\":{\"content\":\"// ViewsCount.tsx\\n\\nimport { useEffect, useState } from 'react'\\n\\nconst ViewsCount = ({ currentPage }: { currentPage: string[] }): JSX.Element => {\\n  const [views, setViews] = useState()\\n\\n  useEffect(() => {\\n    const fetchViews = async () => {\\n      const visitsData = await fetch(`/visitors/count?${currentPage}`)\\n      const visits = await visitsData.json()\\n\\n      setViews(visits)\\n    }\\n\\n    fetchViews()\\n  }, [currentPage])\\n\\n  return (\\n    <span className=\\\"mt-8 text-base text-slate-400/90 md:mt-0\\\">Views: {views}</span>\\n  );\\n}\\n\\nexport default ViewsCount;\\n\"},\"children\":[],\"type\":\"text\",\"annotations\":[],\"slots\":{},\"location\":{\"start\":{\"line\":267},\"end\":{\"line\":293}}}],\"type\":\"fence\",\"annotations\":[],\"slots\":{},\"location\":{\"start\":{\"line\":267},\"end\":{\"line\":293}}},{\"$$mdtype\":\"Node\",\"errors\":[],\"lines\":[294,295],\"inline\":false,\"attributes\":{},\"children\":[{\"$$mdtype\":\"Node\",\"errors\":[],\"lines\":[294,295],\"inline\":false,\"attributes\":{},\"children\":[{\"$$mdtype\":\"Node\",\"errors\":[],\"lines\":[294,295],\"inline\":true,\"attributes\":{\"content\":\"The combination of these two components results in a \\\"Loading Views...\\\" text while the view counter is fetching it's number from the DB, and the number of views when it's ready:\"},\"children\":[],\"type\":\"text\",\"annotations\":[],\"slots\":{},\"location\":{\"start\":{\"line\":294},\"end\":{\"line\":295}}}],\"type\":\"inline\",\"annotations\":[],\"slots\":{},\"location\":{\"start\":{\"line\":294},\"end\":{\"line\":295}}}],\"type\":\"paragraph\",\"annotations\":[],\"slots\":{},\"location\":{\"start\":{\"line\":294},\"end\":{\"line\":295}}},{\"$$mdtype\":\"Node\",\"errors\":[],\"lines\":[296,297],\"inline\":false,\"attributes\":{},\"children\":[{\"$$mdtype\":\"Node\",\"errors\":[],\"lines\":[296,297],\"inline\":false,\"attributes\":{},\"children\":[{\"$$mdtype\":\"Node\",\"errors\":[],\"lines\":[296,297],\"inline\":true,\"attributes\":{\"alt\":\"Views counter\",\"src\":\"assets/blog/posts/exploring-astro-db/views.png\",\"__optimizedSrc\":{\"src\":\"/_astro/views.2BBql5Rl.png\",\"width\":2492,\"height\":184,\"format\":\"png\",\"fsPath\":\"/home/rosnovsky/code/rosnovsky.us/src/assets/blog/posts/exploring-astro-db/views.png\"}},\"children\":[],\"type\":\"image\",\"annotations\":[],\"slots\":{},\"location\":{\"start\":{\"line\":296},\"end\":{\"line\":297}}}],\"type\":\"inline\",\"annotations\":[],\"slots\":{},\"location\":{\"start\":{\"line\":296},\"end\":{\"line\":297}}}],\"type\":\"paragraph\",\"annotations\":[],\"slots\":{},\"location\":{\"start\":{\"line\":296},\"end\":{\"line\":297}}},{\"$$mdtype\":\"Node\",\"errors\":[],\"lines\":[298,299],\"inline\":false,\"attributes\":{},\"children\":[{\"$$mdtype\":\"Node\",\"errors\":[],\"lines\":[298,299],\"inline\":false,\"attributes\":{},\"children\":[{\"$$mdtype\":\"Node\",\"errors\":[],\"lines\":[298,299],\"inline\":true,\"attributes\":{\"content\":\"Finally, how is the count number gets returned from the database?\"},\"children\":[],\"type\":\"text\",\"annotations\":[],\"slots\":{},\"location\":{\"start\":{\"line\":298},\"end\":{\"line\":299}}}],\"type\":\"inline\",\"annotations\":[],\"slots\":{},\"location\":{\"start\":{\"line\":298},\"end\":{\"line\":299}}}],\"type\":\"paragraph\",\"annotations\":[],\"slots\":{},\"location\":{\"start\":{\"line\":298},\"end\":{\"line\":299}}},{\"$$mdtype\":\"Node\",\"errors\":[],\"lines\":[300,334],\"inline\":false,\"attributes\":{\"content\":\"// src/pages/visitors/count.ts\\n\\nimport { Visits, db, eq, and } from 'astro:db';\\nimport type { APIRoute } from 'astro';\\n\\nexport const prerender = false;\\n\\nexport const GET: APIRoute = async (data) => {\\n  const currentPage = data.request.url.split('?')[1].split(',')\\n\\n  const visitsData = await db\\n    .select()\\n    .from(Visits)\\n    .where(\\n      and(\\n        // this is the part where some wierd specifics of my site come into play\\n        eq(Visits.page, currentPage[0] === '' ? \\\"home\\\" : currentPage[0]),\\n        eq(Visits.content, currentPage[1] ? currentPage[1] : 'none')\\n      )\\n    )\\n\\n  const visits = visitsData.reduce((acc, item) => {\\n    return acc + item.visitor_count\\n  }, 0)\\n\\n  return new Response(JSON.stringify(visits), {\\n    status: 200,\\n    headers: {\\n      \\\"Content-Type\\\": \\\"application/json\\\"\\n    }\\n  });\\n}\\n\",\"language\":\"ts\"},\"children\":[{\"$$mdtype\":\"Node\",\"errors\":[],\"lines\":[300,334],\"inline\":false,\"attributes\":{\"content\":\"// src/pages/visitors/count.ts\\n\\nimport { Visits, db, eq, and } from 'astro:db';\\nimport type { APIRoute } from 'astro';\\n\\nexport const prerender = false;\\n\\nexport const GET: APIRoute = async (data) => {\\n  const currentPage = data.request.url.split('?')[1].split(',')\\n\\n  const visitsData = await db\\n    .select()\\n    .from(Visits)\\n    .where(\\n      and(\\n        // this is the part where some wierd specifics of my site come into play\\n        eq(Visits.page, currentPage[0] === '' ? \\\"home\\\" : currentPage[0]),\\n        eq(Visits.content, currentPage[1] ? currentPage[1] : 'none')\\n      )\\n    )\\n\\n  const visits = visitsData.reduce((acc, item) => {\\n    return acc + item.visitor_count\\n  }, 0)\\n\\n  return new Response(JSON.stringify(visits), {\\n    status: 200,\\n    headers: {\\n      \\\"Content-Type\\\": \\\"application/json\\\"\\n    }\\n  });\\n}\\n\"},\"children\":[],\"type\":\"text\",\"annotations\":[],\"slots\":{},\"location\":{\"start\":{\"line\":300},\"end\":{\"line\":334}}}],\"type\":\"fence\",\"annotations\":[],\"slots\":{},\"location\":{\"start\":{\"line\":300},\"end\":{\"line\":334}}},{\"$$mdtype\":\"Node\",\"errors\":[],\"lines\":[335,336],\"inline\":false,\"attributes\":{},\"children\":[{\"$$mdtype\":\"Node\",\"errors\":[],\"lines\":[335,336],\"inline\":false,\"attributes\":{},\"children\":[{\"$$mdtype\":\"Node\",\"errors\":[],\"lines\":[335,336],\"inline\":true,\"attributes\":{\"content\":\"And there you have it. But we are not done yet!\"},\"children\":[],\"type\":\"text\",\"annotations\":[],\"slots\":{},\"location\":{\"start\":{\"line\":335},\"end\":{\"line\":336}}}],\"type\":\"inline\",\"annotations\":[],\"slots\":{},\"location\":{\"start\":{\"line\":335},\"end\":{\"line\":336}}}],\"type\":\"paragraph\",\"annotations\":[],\"slots\":{},\"location\":{\"start\":{\"line\":335},\"end\":{\"line\":336}}},{\"$$mdtype\":\"Node\",\"errors\":[],\"lines\":[337,338],\"inline\":false,\"attributes\":{\"level\":3},\"children\":[{\"$$mdtype\":\"Node\",\"errors\":[],\"lines\":[337,338],\"inline\":false,\"attributes\":{},\"children\":[{\"$$mdtype\":\"Node\",\"errors\":[],\"lines\":[337,338],\"inline\":true,\"attributes\":{\"content\":\"Popular posts\"},\"children\":[],\"type\":\"text\",\"annotations\":[],\"slots\":{},\"location\":{\"start\":{\"line\":337},\"end\":{\"line\":338}}}],\"type\":\"inline\",\"annotations\":[],\"slots\":{},\"location\":{\"start\":{\"line\":337},\"end\":{\"line\":338}}}],\"type\":\"heading\",\"annotations\":[],\"slots\":{},\"location\":{\"start\":{\"line\":337},\"end\":{\"line\":338}}},{\"$$mdtype\":\"Node\",\"errors\":[],\"lines\":[339,340],\"inline\":false,\"attributes\":{},\"children\":[{\"$$mdtype\":\"Node\",\"errors\":[],\"lines\":[339,340],\"inline\":false,\"attributes\":{},\"children\":[{\"$$mdtype\":\"Node\",\"errors\":[],\"lines\":[339,340],\"inline\":true,\"attributes\":{\"content\":\"With all this in place, I can now display not only latest posts but also most popular (by views). Note that I make sure to remove the three latest posts that are already featured on the page so that I don't get identical posts in Latest and Popular sections.\"},\"children\":[],\"type\":\"text\",\"annotations\":[],\"slots\":{},\"location\":{\"start\":{\"line\":339},\"end\":{\"line\":340}}}],\"type\":\"inline\",\"annotations\":[],\"slots\":{},\"location\":{\"start\":{\"line\":339},\"end\":{\"line\":340}}}],\"type\":\"paragraph\",\"annotations\":[],\"slots\":{},\"location\":{\"start\":{\"line\":339},\"end\":{\"line\":340}}},{\"$$mdtype\":\"Node\",\"errors\":[],\"lines\":[341,388],\"inline\":false,\"attributes\":{\"content\":\"---\\nimport Container from '@components/Container.astro'\\nimport BlogGrid from '@components/blog/BlogGrid.astro'\\nimport Underline from '@components/illustrations/Underline.astro'\\nimport { db, Visits, ne, and, desc } from 'astro:db'\\nimport { getSortedPosts } from '@utils/posts'\\nimport type { Post } from '@types'\\nimport { getCollection } from 'astro:content'\\n\\nconst featuredPosts: Post[] = (await getSortedPosts()).slice(0, 3)\\n\\nconst popularPostsByVisits = new Set(\\n  await db\\n    .select()\\n    .from(Visits)\\n    .where(\\n      ne(Visits.content, \\\"none\\\")\\n    )\\n    .orderBy(\\n      desc(Visits.visitor_count))\\n    .limit(6)\\n    .then((rows) => (rows.map((row) => {\\n      return row.content\\n      })\\n    ))\\n)\\n\\nconst featuredPostsSlugs = featuredPosts.map((post) => post.slug.split('/').pop())\\n\\nconst popularPostsSlugs = Array.from(popularPostsByVisits).filter((slug) => !featuredPostsSlugs.includes(slug)).slice(0, 3)\\n\\nconst allPosts: Post[] = await getSortedPosts();\\n\\nconst popularPosts = allPosts.filter((post) => popularPostsSlugs.includes(post.slug.split('/').pop()!))\\n---\\n\\n<section\\n  class=\\\"overflow-hidden bg-white py-16 dark:bg-slate-900 sm:pt-24 lg:pt-28\\\"\\n>\\n  <Container>\\n    <h2>Popular Posts</h2>\\n    <BlogGrid posts={popularPosts} />\\n  </Container>\\n</section>\\n\\n\",\"language\":\"tsx\"},\"children\":[{\"$$mdtype\":\"Node\",\"errors\":[],\"lines\":[341,388],\"inline\":false,\"attributes\":{\"content\":\"---\\nimport Container from '@components/Container.astro'\\nimport BlogGrid from '@components/blog/BlogGrid.astro'\\nimport Underline from '@components/illustrations/Underline.astro'\\nimport { db, Visits, ne, and, desc } from 'astro:db'\\nimport { getSortedPosts } from '@utils/posts'\\nimport type { Post } from '@types'\\nimport { getCollection } from 'astro:content'\\n\\nconst featuredPosts: Post[] = (await getSortedPosts()).slice(0, 3)\\n\\nconst popularPostsByVisits = new Set(\\n  await db\\n    .select()\\n    .from(Visits)\\n    .where(\\n      ne(Visits.content, \\\"none\\\")\\n    )\\n    .orderBy(\\n      desc(Visits.visitor_count))\\n    .limit(6)\\n    .then((rows) => (rows.map((row) => {\\n      return row.content\\n      })\\n    ))\\n)\\n\\nconst featuredPostsSlugs = featuredPosts.map((post) => post.slug.split('/').pop())\\n\\nconst popularPostsSlugs = Array.from(popularPostsByVisits).filter((slug) => !featuredPostsSlugs.includes(slug)).slice(0, 3)\\n\\nconst allPosts: Post[] = await getSortedPosts();\\n\\nconst popularPosts = allPosts.filter((post) => popularPostsSlugs.includes(post.slug.split('/').pop()!))\\n---\\n\\n<section\\n  class=\\\"overflow-hidden bg-white py-16 dark:bg-slate-900 sm:pt-24 lg:pt-28\\\"\\n>\\n  <Container>\\n    <h2>Popular Posts</h2>\\n    <BlogGrid posts={popularPosts} />\\n  </Container>\\n</section>\\n\\n\"},\"children\":[],\"type\":\"text\",\"annotations\":[],\"slots\":{},\"location\":{\"start\":{\"line\":341},\"end\":{\"line\":388}}}],\"type\":\"fence\",\"annotations\":[],\"slots\":{},\"location\":{\"start\":{\"line\":341},\"end\":{\"line\":388}}},{\"$$mdtype\":\"Node\",\"errors\":[],\"lines\":[389,390],\"inline\":false,\"attributes\":{\"level\":2},\"children\":[{\"$$mdtype\":\"Node\",\"errors\":[],\"lines\":[389,390],\"inline\":false,\"attributes\":{},\"children\":[{\"$$mdtype\":\"Node\",\"errors\":[],\"lines\":[389,390],\"inline\":true,\"attributes\":{\"content\":\"All done!\"},\"children\":[],\"type\":\"text\",\"annotations\":[],\"slots\":{},\"location\":{\"start\":{\"line\":389},\"end\":{\"line\":390}}}],\"type\":\"inline\",\"annotations\":[],\"slots\":{},\"location\":{\"start\":{\"line\":389},\"end\":{\"line\":390}}}],\"type\":\"heading\",\"annotations\":[],\"slots\":{},\"location\":{\"start\":{\"line\":389},\"end\":{\"line\":390}}},{\"$$mdtype\":\"Node\",\"errors\":[],\"lines\":[391,392],\"inline\":false,\"attributes\":{},\"children\":[{\"$$mdtype\":\"Node\",\"errors\":[],\"lines\":[391,392],\"inline\":false,\"attributes\":{},\"children\":[{\"$$mdtype\":\"Node\",\"errors\":[],\"lines\":[391,392],\"inline\":true,\"attributes\":{\"content\":\"Well, now we are done. Setting up Astro DB was easy, it's easy to use, and it works as expected. I bet there are some awesome improvements coming, but in the meantime, Astro DB is my go-to for all my Astro-based projects.\"},\"children\":[],\"type\":\"text\",\"annotations\":[],\"slots\":{},\"location\":{\"start\":{\"line\":391},\"end\":{\"line\":392}}}],\"type\":\"inline\",\"annotations\":[],\"slots\":{},\"location\":{\"start\":{\"line\":391},\"end\":{\"line\":392}}}],\"type\":\"paragraph\",\"annotations\":[],\"slots\":{},\"location\":{\"start\":{\"line\":391},\"end\":{\"line\":392}}},{\"$$mdtype\":\"Node\",\"errors\":[],\"lines\":[393,394],\"inline\":false,\"attributes\":{},\"children\":[{\"$$mdtype\":\"Node\",\"errors\":[],\"lines\":[393,394],\"inline\":false,\"attributes\":{},\"children\":[{\"$$mdtype\":\"Node\",\"errors\":[],\"lines\":[393,394],\"inline\":true,\"attributes\":{\"content\":\"How would you use Astro DB? Any cool ideas? :)\"},\"children\":[],\"type\":\"text\",\"annotations\":[],\"slots\":{},\"location\":{\"start\":{\"line\":393},\"end\":{\"line\":394}}}],\"type\":\"inline\",\"annotations\":[],\"slots\":{},\"location\":{\"start\":{\"line\":393},\"end\":{\"line\":394}}}],\"type\":\"paragraph\",\"annotations\":[],\"slots\":{},\"location\":{\"start\":{\"line\":393},\"end\":{\"line\":394}}}],\"type\":\"document\",\"annotations\":[],\"slots\":{}}";

const getHeadings = createGetHeadings(stringifiedAst, markdocConfig);
const Content = createContentComponent(
	$$Renderer,
	stringifiedAst,
	markdocConfig,
  options,
	tagComponentMap,
	nodeComponentMap,
);

export { Content, getHeadings };
